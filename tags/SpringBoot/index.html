<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>萤火虫的博客</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script>
</head>
<body class="home">
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="萤火虫的博客"><span class="octicon octicon-mark-github"></span> 萤火虫的博客</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="首页">首页</a>
        
              
              <a href="/categories/"  class=" site-header-nav-item hvr-underline-from-center" title="分类">分类</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="开源">开源</a>
        
              
              <a href="/about/"  class=" site-header-nav-item hvr-underline-from-center" title="关于">关于</a>
        
      </nav>
  </div>
</header>

	<section class="banner-false">
    <div class="collection-head">
        <div class="container">
            <div class="collection-title">
                <h1 class="collection-header" id="site-description">
                    111
                </h1>
                <div class="collection-info">
                    
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-location">
                                   
                                        上海, 中国
                                    
                                </span>
                                
                            
                        </span>
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-mark-github">
                                   
                                </span>
                                
                                    <a href="http://github.com/vanicesun" target="_blank">vanicesun</a>
                                
                            
                        </span>
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-organization">
                                   
                                        组织/公司
                                    
                                </span>
                                
                            
                        </span>
                    
                </div>
            </div>
        </div>
    </div>
</section>
	   <section class="container">
    <div class="columns">
        <div class="column two-thirds">
            
                  <article id="post-speingboot-session" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2020/01/06/speingboot-session/">实现Session共享</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>2020年，只有更加努力的自己，才能创造自己更加美好的生活！乾坤未定，你我皆是黑马！</p>
</blockquote>
<h3 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h3><p>在传统的单服务架构中，一般来说，只有一个服务器，那么不存在 Session 共享问题，但是在分布式/集群项目中，Session 共享则是一个必须面对的问题，先看一个简单的架构图：<br><img src="http://www.javaboy.org/images/boot/14-1.png#pic_center" alt=""><br>在这样的架构中，会出现一些单服务中不存在的问题，例如客户端发起一个请求，这个请求到达 Nginx 上之后，被 Nginx 转发到 Tomcat A 上，然后在 Tomcat A 上往 session 中保存了一份数据，下次又来一个请求，这个请求被转发到 Tomcat B 上，此时再去 Session 中获取数据，发现没有之前的数据。<br>对于这一类问题的解决，思路很简单，就是将各个服务之间需要共享的数据，保存到一个公共的地方（主流方案就是 Redis）：<br><img src="http://www.javaboy.org/images/boot/14-2.png#pic_center" alt=""><br>当所有 Tomcat 需要往 Session 中写数据时，都往 Redis 中写，当所有 Tomcat 需要读数据时，都从 Redis 中读。这样，不同的服务就可以使用相同的 Session 数据了。<br>这样的方案，可以由开发者手动实现，即手动往 Redis 中存储数据，手动从 Redis 中读取数据，相当于使用一些 Redis 客户端工具来实现这样的功能，毫无疑问，手动实现工作量还是蛮大的。<br>一个简化的方案就是使用 Spring Session 来实现这一功能，Spring Session 就是使用 Spring 中的代理过滤器，将所有的 Session 操作拦截下来，自动的将数据 同步到 Redis 中，或者自动的从 Redis 中读取数据。<br>对于开发者来说，所有关于 Session 同步的操作都是透明的，开发者使用 Spring Session，一旦配置完成后，具体的用法就像使用一个普通的 Session 一样。</p>
<h2 id="实战-创建工程"><a href="#实战-创建工程" class="headerlink" title="实战-创建工程"></a>实战-创建工程</h2><p>首先 创建一个 Spring Boot 工程，引入 Web、Spring Session 以及 Redis:<br><img src="http://www.javaboy.org/images/boot/14-3.png#pic_center" alt=""><br>创建成功之后，pom.xml 文件如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">    &lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;</span><br><span class="line">    &lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>
<p><strong>注意：</strong><br>这里我使用的 Spring Boot 版本是 2.1.4 ，如果使用当前最新版 Spring Boot2.1.5 的话，除了上面这些依赖之外，需要额外添加 Spring Security 依赖（其他操作不受影响，仅仅只是多了一个依赖，当然也多了 Spring Security 的一些默认认证流程）。</p>
<h2 id="配置-Redis"><a href="#配置-Redis" class="headerlink" title="配置 Redis"></a>配置 Redis</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.redis.host=192.168.66.128</span><br><span class="line">spring.redis.port=6379</span><br><span class="line">spring.redis.password=123</span><br><span class="line">spring.redis.database=0</span><br></pre></td></tr></table></figure>
<p>这里的 Redis ，我虽然配置了四行，但是考虑到端口默认就是 6379 ，database 默认就是 0，所以真正要配置的，其实就是两行。</p>
<h2 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h2><p>配置完成后 ，就可以使用 Spring Session 了，其实就是使用普通的 HttpSession ，其他的 Session 同步到 Redis 等操作，框架已经自动帮你完成了：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">public class HelloController &#123;</span><br><span class="line">    @Value(&quot;$&#123;server.port&#125;&quot;)</span><br><span class="line">    Integer port;</span><br><span class="line">    @GetMapping(&quot;/set&quot;)</span><br><span class="line">    public String set(HttpSession session) &#123;</span><br><span class="line">        session.setAttribute(&quot;user&quot;, &quot;javaboy&quot;);</span><br><span class="line">        return String.valueOf(port);</span><br><span class="line">    &#125;</span><br><span class="line">    @GetMapping(&quot;/get&quot;)</span><br><span class="line">    public String get(HttpSession session) &#123;</span><br><span class="line">        return session.getAttribute(&quot;user&quot;) + &quot;:&quot; + port;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>考虑到一会 Spring Boot 将以集群的方式启动 ，为了获取每一个请求到底是哪一个 Spring Boot 提供的服务，需要在每次请求时返回当前服务的端口号，因此这里我注入了 server.port 。<br>接下来 ，项目打包：<br><img src="http://www.javaboy.org/images/boot/14-4.png#pic_center" alt=""><br>打包之后，启动项目的两个实例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">java -jar sessionshare-0.0.1-SNAPSHOT.jar --server.port=8080</span><br><span class="line">java -jar sessionshare-0.0.1-SNAPSHOT.jar --server.port=8081</span><br></pre></td></tr></table></figure>
<p>然后先访问 localhost:8080/set 向 8080 这个服务的 Session 中保存一个变量，访问完成后，数据就已经自动同步到 Redis 中 了 ：<br><img src="http://www.javaboy.org/images/boot/14-5.png#pic_center" alt=""><br>然后，再调用 localhost:8081/get 接口，就可以获取到 8080 服务的 session 中的数据：<br><img src="http://www.javaboy.org/images/boot/14-6.png#pic_center" alt=""></p>
<p>此时关于 session 共享的配置就已经全部完成了，session 共享的效果我们已经看到了，但是每次访问都是我自己手动切换服务实例，因此，接下来我们来引入 Nginx ，实现服务实例自动切换。</p>
<h2 id="引入-Nginx"><a href="#引入-Nginx" class="headerlink" title="引入 Nginx"></a>引入 Nginx</h2><p>很简单，进入 Nginx 的安装目录的 conf 目录下（默认是在 /usr/local/nginx/conf），编辑 nginx.conf 文件:<br><img src="http://www.javaboy.org/images/boot/14-7.png#pic_center" alt=""></p>
<p><strong>在这段配置中：</strong></p>
<ul>
<li>upstream 表示配置上游服务器</li>
<li>javaboy.org 表示服务器集群的名字，这个可以随意取名字</li>
<li>upstream 里边配置的是一个个的单独服务</li>
<li>weight 表示服务的权重，意味者将有多少比例的请求从 Nginx 上转发到该服务上</li>
<li>location 中的 proxy_pass 表示请求转发的地址，/ 表示拦截到所有的请求，转发转发到刚刚配置好的服务集群中</li>
<li>proxy_redirect 表示设置当发生重定向请求时，nginx 自动修正响应头数据（默认是 Tomcat 返回重定向，此时重定向的地址是 Tomcat 的地址，我们需要将之修改使之成为 Nginx 的地址）。<br>配置完成后，将本地的 Spring Boot 打包好的 jar 上传到 Linux ，然后在 Linux 上分别启动两个 Spring Boot 实例：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar sessionshare-0.0.1-SNAPSHOT.jar --server.port=8080 &amp;</span><br><span class="line">nohup java -jar sessionshare-0.0.1-SNAPSHOT.jar --server.port=8081 &amp;</span><br></pre></td></tr></table></figure>
其中</li>
</ul>
<p><strong>nohup</strong> 表示当终端关闭时，Spring Boot 不要停止运行<br><strong>&amp;</strong> 表示让 Spring Boot 在后台启动<br>配置完成后，重启 Nginx：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/usr/local/nginx/sbin/nginx -s reload</span><br></pre></td></tr></table></figure>
<p>Nginx 启动成功后，我们首先手动清除 Redis 上的数据，然后访问 192.168.66.128/set 表示向 session 中保存数据，这个请求首先会到达 Nginx 上，再由 Nginx 转发给某一个 Spring Boot 实例：<br><img src="http://www.javaboy.org/images/boot/14-8.png#pic_center" alt=""><br>如上，表示端口为 8081 的 Spring Boot 处理了这个 /set 请求，再访问 /get 请求：<br><img src="http://www.javaboy.org/images/boot/14-9.png#pic_center" alt=""><br>可以看到，/get 请求是被端口为 8080 的服务所处理的。</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2020-01-06T05:51:00.000Z" itemprop="datePublished">2020-01-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/springboot、session/' title=''>springboot、session</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/springboot/" rel="tag">springboot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
        </div>
        <div class="column one-third">
          <!--处理未安装 search 插件 默认 Google 搜索-->
 

<h3>Search</h3>

<div id="site_search">

	<!-- Google -->
	

	<!-- 本地搜索 -->
	
		<form id="search-form" >
			<input type="text" id="search" placeholder="Search" >
			<button type="button" class="btn btn-default" id="site_search_do"><span class="octicon octicon-search"></span></button>
		</form>

		<div id="local-search-result"></div>

		<script src="/js/search.js"></script>	
		<script type="text/javascript">
			$(function(){
				var currentIndex = -1;
				var search_path = "search.xml";
				if (!search_path) search_path = "search.xml";
				var path = "/" + search_path;
				searchFunc(path, 'search', 'local-search-result');

				$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
					var liNode = $("#local-search-result>.search-result-list li");
					liNode.removeClass("hover");
					currentIndex = $("#local-search-result>.search-result-list li").index($(this));
					liNode.eq(currentIndex).addClass("hover");
				})

				$("#search-form").submit(function(){
					return false;
				})

				$("#search").keydown(function(event){
					var keyCode = event.keyCode;
					var liNode = $("#local-search-result>.search-result-list li");
					if(keyCode == 38 || keyCode == 40 || keyCode == 13){
						liNode.removeClass("hover");
						if(keyCode == 38){
							if(currentIndex - 1 >= 0) currentIndex --;
						}
						if(keyCode == 40){
							if(currentIndex + 1 < liNode.length) currentIndex ++;
						}
						if(keyCode == 13){
							location.href = liNode.eq(currentIndex).find("a").attr("href");
						}
						liNode.eq(currentIndex).addClass("hover");
						return false;
					}else{
						currentIndex = -1;
					}
				})
			})
		</script>

	

</div>

<h3>Popular Repositories</h3>
    <div class="popular-container"></div>
    
    <script type="text/template" id="popular-list-template">
        <a href="{%=clone_url%}" class="card text-center" target="_blank">
            <div class="thumbnail">
                <div class="card-image geopattern" data-pattern-id="{%=name%}">
                    <div class="card-image-cell">
                        <h3 class="card-title">
                            {%=name%}
                        </h3>
                    </div>
                </div>
                <div class="caption">
                    <div class="card-description">
                        <p class="card-text">
                            {%=description%}
                        </p>
                    </div>
                    <div class="card-text">
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=stargazers_count%} stars">
                            <span class="octicon octicon-star"></span> {%=stargazers_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=forks_count%} forks">
                            <span class="octicon octicon-git-branch"></span> {%=forks_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="最后更新时间：{%=updated_at%}">
                            <span class="octicon octicon-clock"></span>
                            <time datetime="{%=updated_at%}">{%=updated_at%}</time>
                        </span>
                    </div>
                </div>
            </div>
        </a>
    </script>

    <script src="/js/baiduTemplate.js"></script>
    <script type="text/javascript">
        var popular_repos = function(){

            var baiduTpl = new Object();

            var handleTpl = function(){
                baiduTpl.popular_list = baidu.template("popular-list-template");
            };

            var handleGithub = function(){
                var popularContainer = $(".popular-container");

                var repos = "vue-hr,vue-mobil,spring-boot-examples".split(",");
                for(var i in repos){
                    var name = repos[i];
                    $.get("https://api.github.com/repos/vanicesun/"+name,handle);
                }

                function handle(result){
                    result.updated_at = result.updated_at.split("T")[0];
                    if(result){
                        var html = baiduTpl.popular_list(result);
                        popularContainer.append(html);
                        $(".geopattern").each(function(){           
                            $(this).geopattern($(this).data('pattern-id'));
                        });
                    }
                }
            };

            return {
                init:function(){
                    handleTpl();
                    handleGithub();
                }
            }
        }; 
        $(popular_repos().init);
    </script>

        </div>
    </div>

    
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" target="_blank" rel="noopener" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" target="_blank" rel="noopener" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="首页">首页</a>
                  </li>
            
                  
                  <li>
                    <a href="/categories/"  title="分类">分类</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="开源">开源</a>
                  </li>
            
                  
                  <li>
                    <a href="/about/"  title="关于">关于</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	</body>
</html>          ],</span><br><span class="line">               &quot;defaultMessage&quot;: &quot;需要匹配正则表达式\&quot;[a-zA-Z0-9_]&#123;6,30&#125;\&quot;&quot;,</span><br><span class="line">               &quot;objectName&quot;: &quot;formRequest&quot;,</span><br><span class="line">               &quot;field&quot;: &quot;name&quot;,</span><br><span class="line">               &quot;rejectedValue&quot;: &quot;fefe&quot;,</span><br><span class="line">               &quot;bindingFailure&quot;: false,</span><br><span class="line">               &quot;code&quot;: &quot;Pattern&quot;</span><br><span class="line">           &#125;,</span><br><span class="line">           &#123;</span><br><span class="line">               &quot;codes&quot;: [</span><br><span class="line">                   &quot;Min.formRequest.age&quot;,</span><br><span class="line">                   &quot;Min.age&quot;,</span><br><span class="line">                   &quot;Min.int&quot;,</span><br><span class="line">                   &quot;Min&quot;</span><br><span class="line">               ],</span><br><span class="line">               &quot;arguments&quot;: [</span><br><span class="line">                   &#123;</span><br><span class="line">                       &quot;codes&quot;: [</span><br><span class="line">                           &quot;formRequest.age&quot;,</span><br><span class="line">                           &quot;age&quot;</span><br><span class="line">                       ],</span><br><span class="line">                       &quot;arguments&quot;: null,</span><br><span class="line">                       &quot;defaultMessage&quot;: &quot;age&quot;,</span><br><span class="line">                       &quot;code&quot;: &quot;age&quot;</span><br><span class="line">                   &#125;,</span><br><span class="line">                   5</span><br><span class="line">               ],</span><br><span class="line">               &quot;defaultMessage&quot;: &quot;最小不能小于5&quot;,</span><br><span class="line">               &quot;objectName&quot;: &quot;formRequest&quot;,</span><br><span class="line">               &quot;field&quot;: &quot;age&quot;,</span><br><span class="line">               &quot;rejectedValue&quot;: 2,</span><br><span class="line">               &quot;bindingFailure&quot;: false,</span><br><span class="line">               &quot;code&quot;: &quot;Min&quot;</span><br><span class="line">           &#125;</span><br><span class="line">       ],</span><br><span class="line">       &quot;message&quot;: &quot;Validation failed for object=&apos;formRequest&apos;. Error count: 3&quot;,</span><br><span class="line">       &quot;path&quot;: &quot;/validate/form&quot;</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>
<p>如果是参数类型不匹配，会得到：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">        &quot;timestamp&quot;: 1530955359265,</span><br><span class="line">        &quot;status&quot;: 400,</span><br><span class="line">        &quot;error&quot;: &quot;Bad Request&quot;,</span><br><span class="line">        &quot;exception&quot;: &quot;org.springframework.validation.BindException&quot;,</span><br><span class="line">        &quot;errors&quot;: [</span><br><span class="line">            &#123;</span><br><span class="line">                &quot;codes&quot;: [</span><br><span class="line">                    &quot;typeMismatch.formRequest.age&quot;,</span><br><span class="line">                    &quot;typeMismatch.age&quot;,</span><br><span class="line">                    &quot;typeMismatch.int&quot;,</span><br><span class="line">                    &quot;typeMismatch&quot;</span><br><span class="line">                ],</span><br><span class="line">                &quot;arguments&quot;: [</span><br><span class="line">                    &#123;</span><br><span class="line">                        &quot;codes&quot;: [</span><br><span class="line">                            &quot;formRequest.age&quot;,</span><br><span class="line">                            &quot;age&quot;</span><br><span class="line">                        ],</span><br><span class="line">                        &quot;arguments&quot;: null,</span><br><span class="line">                        &quot;defaultMessage&quot;: &quot;age&quot;,</span><br><span class="line">                        &quot;code&quot;: &quot;age&quot;</span><br><span class="line">                    &#125;</span><br><span class="line">                ],</span><br><span class="line">                &quot;defaultMessage&quot;: &quot;Failed to convert property value of type &apos;java.lang.String&apos; </span><br><span class="line">    to required type &apos;int&apos; for property &apos;age&apos;; nested exception is java.lang.NumberFormatException: </span><br><span class="line">    For input string: \&quot;\&quot;&quot;,</span><br><span class="line">                &quot;objectName&quot;: &quot;formRequest&quot;,</span><br><span class="line">                &quot;field&quot;: &quot;age&quot;,</span><br><span class="line">                &quot;rejectedValue&quot;: &quot;&quot;,</span><br><span class="line">                &quot;bindingFailure&quot;: true,</span><br><span class="line">                &quot;code&quot;: &quot;typeMismatch&quot;</span><br><span class="line">            &#125;</span><br><span class="line">        ],</span><br><span class="line">        &quot;message&quot;: &quot;Validation failed for object=&apos;formRequest&apos;. Error count: 1&quot;,</span><br><span class="line">        &quot;path&quot;: &quot;/validate/form&quot;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>Form表单参数上，使用@Valid注解可达到同样目的，而关于两者的区别则是：<br>@Valid 基于JSR303，即 Bean Validation 1.0，由Hibernate Validator实现；<br> @Validated 基于JSR349，是Bean Validation 1.1，由Spring框架扩展实现；</p>
</blockquote>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-12-10T07:14:39.000Z" itemprop="datePublished">2019-12-10</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-ss-boot" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/07/ss-boot/">SpringBoot开发案例之奇技淫巧</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>程序员都有着一种天生的好奇心，这种好奇心引导着我们的编程生涯。写几行代码，装载到计算机里，让它按照你的思路工作，这是非常有趣的事情。但随着开发的东西越来越多，我们变的越来越忙，这种好奇心会慢慢的减退。我们应该时不时的用一些新思路挑战自己，让自己的思想保持锋锐和专注，提醒自己为什么当初选择码农这条道路。</p>
</blockquote>
<h3 id="版本标注"><a href="#版本标注" class="headerlink" title="版本标注"></a>版本标注</h3><p>小伙伴们可能会发现pom.xml中很多是没有版本号的比如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>其实，在头部我们加了以下配置：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.5.2.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt;</span><br><span class="line">&lt;/parent&gt;</span><br></pre></td></tr></table></figure>
<p><strong>spring-boot-starter-parent包含了大量配置好的依赖管理，在自己项目添加这些依赖的时候不需要写<version>版本号</strong></p>
<h3 id="注解说明"><a href="#注解说明" class="headerlink" title="注解说明"></a>注解说明</h3><p>@SpringBootApplication : 是Spring Boot 项目的核心注解 主要目的是开启自动配置<br>@SpringBootApplication注解是一个组合注解,主要组合了@Configuration .+@EnableAutoConfiguration.+@ComponentScan<br>@Value : 属性注入,读取properties或者 Yml 文件中的属性<br>@ConfigurationProperties : 将properties属性和一个Bean及其属性关联,从而实现类型安全的配置<br>@ConfigurationProperties(prefix = “author”,locations = {“classpath:config/author.properties”})<br>通过@ConfigurationProperties加载配置,通过prefix属性指定配置前缀,通过location指定配置文件位置<br>@EnableAutoConfiguration 注解:作用在于让 Spring Boot 根据应用所声明的依赖来对 Spring 框架进行自动配置<br>这个注解告诉Spring Boot根据添加的jar依赖猜测你想如何配置Spring。由于spring-boot-starter-web添加了Tomcat和Spring MVC，所以auto-configuration将假定你正在开发一个web应用并相应地对Spring进行设置。<br>@ Configuration @EnableAutoConfiguration (exclude={xxxx.class}) 禁用特定的自动配置<br>@SpringBootApplication 注解等价于以默认属性使用 @Configuration，@EnableAutoConfiguration和 @ComponentScan。</p>
<h3 id="热部署"><a href="#热部署" class="headerlink" title="热部署"></a>热部署</h3><p>方法1 添加springloaded依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">     &lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">     &lt;artifactId&gt;springloaded&lt;/artifactId&gt;</span><br><span class="line">     &lt;version&gt;1.2.5.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>原理：基于ASM实现动态生成类或者增强既有类，每次类的修改会被检测到，然后重新生成新的类并加载。如果不懂什么是ASM可以百度JAVA-ASM。</p>
<p>方法2 添加spring-boot-devtools依赖</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>原理：spring-boot-devtools 是一个为开发者服务的一个模块，其中最重要的功能就是自动应用代码更改到最新的App上面去。原理是在发现代码有更改之后，重新启动应用，但是速度比手动停止后再启动还要更快，更快指的不是节省出来的手工操作的时间。其深层原理是使用了两个ClassLoader，一个Classloader加载那些不会改变的类（第三方Jar包），另一个ClassLoader加载会更改的类，称为 restart ClassLoader,这样在有代码更改的时候，原来的restart ClassLoader 被丢弃，重新创建一个restart ClassLoader，由于需要加载的类相比较少，所以实现了较快的重启时间（5秒以内）。</p>
<h3 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h3><p>在 spring boot 中，有两种方式实现文件配置，application.properties 和 application.yml。大家可能对properties 比较熟悉，而另一种yml是基于YAML实现的，YAML 是一种比JSON（json多层次与 会被搞晕的）更直观的表现形式，展示上更易查错和关系描述。因为不需要一个专业工具就可以排查正确性。</p>
<p>下面，我们以server为例展示下两者的不同。</p>
<p><strong>application.properties</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">server.context-path=/springboot</span><br><span class="line">server.port=8080</span><br><span class="line">server.session-timeout=60</span><br><span class="line">server.address=192.168.1.66</span><br><span class="line"></span><br><span class="line">server.tomcat.max-threads=300</span><br><span class="line">server.tomcat.uri-encoding=UTF-8</span><br></pre></td></tr></table></figure>
<p><strong>application.yml</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">server:</span><br><span class="line">    context-path: /springboot</span><br><span class="line">    port: 8080</span><br><span class="line">    session-timeout: 60</span><br><span class="line">    address: 192.168.1.66</span><br><span class="line">    tomcat:</span><br><span class="line">      max-threads: 300</span><br><span class="line">      uri-encoding: UTF-8</span><br><span class="line">logging:</span><br><span class="line">    level:</span><br><span class="line">      root: INFO</span><br></pre></td></tr></table></figure>
<p>yml天然的树状结构，一目了然，层次感强，有没有亮瞎你。当然使用yml要注意，层次间隔必须是空格不能是TAB，并且属性名的值和冒号中间必须有空格。</p>
<h3 id="部署环境"><a href="#部署环境" class="headerlink" title="部署环境"></a>部署环境</h3><p><strong>开发环境(development)</strong><br>application-dev.properties</p>
<p><strong>测试环境(test)</strong><br>application-test.properties</p>
<p><strong>生产环境(production)</strong><br>application-prod.properties</p>
<p>那么如何定义使用哪种配置文件呢？<br>　　在主配置文件application.yml中配置如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring:</span><br><span class="line">  profiles:</span><br><span class="line">    active: dev</span><br></pre></td></tr></table></figure>

<h3 id="属性配置"><a href="#属性配置" class="headerlink" title="属性配置"></a>属性配置</h3><p>如何在代码中获取配置文件中的属性呢？spring-boot为我们提供了这样一种方式，只需要使用@Value注解即可。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@Value(&quot;$&#123;spring.mail.username&#125;&quot;)</span><br><span class="line">public String USER_NAME;</span><br></pre></td></tr></table></figure>
<h3 id="thymeleaf模版"><a href="#thymeleaf模版" class="headerlink" title="thymeleaf模版"></a>thymeleaf模版</h3><p>默认配置下，thymeleaf对html的内容要求很严格，比如，如果少最后的标签封闭符号/，就会报错而转到错误页。</p>
<h3 id="忽略thymeleaf严格的校验"><a href="#忽略thymeleaf严格的校验" class="headerlink" title="忽略thymeleaf严格的校验"></a>忽略thymeleaf严格的校验</h3><p>spring.thymeleaf.mode=LEGACYHTML5</p>
<h3 id="开发阶段设置为false方便调试"><a href="#开发阶段设置为false方便调试" class="headerlink" title="开发阶段设置为false方便调试"></a>开发阶段设置为false方便调试</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">spring.devtools.livereload.enabled=true</span><br><span class="line">spring.thymeleaf.cache=false</span><br><span class="line">spring.thymeleaf.cache-period=0</span><br><span class="line">spring.thymeleaf.template.cache=false</span><br></pre></td></tr></table></figure>

<h3 id="静态资源"><a href="#静态资源" class="headerlink" title="静态资源"></a>静态资源</h3><p>Spring Boot中静态资源（JS, 图片）等应该放在什么位置？</p>
<p>Spring Boot能大大简化WEB应用开发的原因， 最重要的就是遵循“约定优于配置”这一基本原则。Spring Boot的关于静态资源的默认配置已经完全满足绝大部分WEB应用的需求。没必要去弄手续繁杂的自定义，用Spring Boot的约定就好了。</p>
<p>在Maven 工程目录下，所有静态资源都放在src/main/resource目录下，结构如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">src/main/resource</span><br><span class="line">          |__________static</span><br><span class="line">                        |_________js</span><br><span class="line">                        |_________images</span><br><span class="line">                        |_________css</span><br><span class="line">                 .....</span><br></pre></td></tr></table></figure>
<p>比如，我们引入以下css:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;stylesheet&quot; th:href=&quot;@&#123;css/alipay.css&#125;&quot; /&gt;</span><br></pre></td></tr></table></figure>
<h3 id="自定义静态资源"><a href="#自定义静态资源" class="headerlink" title="自定义静态资源"></a>自定义静态资源</h3><h3 id="通过配置文件配置"><a href="#通过配置文件配置" class="headerlink" title="通过配置文件配置"></a>通过配置文件配置</h3><p>在application.properties（或.yml）中配置</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 静态文件请求匹配方式</span><br><span class="line">spring.mvc.static-path-pattern=/**</span><br><span class="line"># 修改默认的静态寻址资源目录 多个使用逗号分隔</span><br><span class="line">spring.resources.static-locations = classpath:/templates/,classpath:/resources/,classpath:/static/</span><br></pre></td></tr></table></figure>
<h3 id="通过代码配置"><a href="#通过代码配置" class="headerlink" title="通过代码配置"></a>通过代码配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">@EnableAutoConfiguration</span><br><span class="line">@ComponentScan(basePackages = &#123; &quot;com.itstyle.modules&quot; &#125;)</span><br><span class="line">public class Application extends WebMvcConfigurerAdapter &#123;</span><br><span class="line">    private static final Logger logger = Logger.getLogger(Application.class);</span><br><span class="line">    @Override</span><br><span class="line">    public void addResourceHandlers(ResourceHandlerRegistry registry) &#123;</span><br><span class="line">        registry.addResourceHandler(&quot;/cert/**&quot;).addResourceLocations(</span><br><span class="line">                &quot;classpath:/cert/&quot;);</span><br><span class="line">        super.addResourceHandlers(registry);</span><br><span class="line">        logger.info(&quot;自定义静态资源目录&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) throws InterruptedException,</span><br><span class="line">            IOException &#123;</span><br><span class="line">        SpringApplication.run(Application.class, args);</span><br><span class="line">        logger.info(&quot;支付项目启动 &quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h3><h3 id="获取文件"><a href="#获取文件" class="headerlink" title="获取文件"></a>获取文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">File file = ResourceUtils.getFile(&quot;classpath:cert/readme.txt&quot;);</span><br></pre></td></tr></table></figure>
<h3 id="获取路径"><a href="#获取路径" class="headerlink" title="获取路径"></a>获取路径</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ClassUtils.getDefaultClassLoader().getResource(&quot;cert&quot;).getPath()</span><br></pre></td></tr></table></figure>
<h3 id="Controller和RestController的区别？"><a href="#Controller和RestController的区别？" class="headerlink" title="Controller和RestController的区别？"></a>Controller和RestController的区别？</h3><p>官方文档：<br>@RestController is a stereotype annotation that combines @ResponseBody and @Controller.<br>意思是：<br>@RestController注解相当于@ResponseBody ＋ @Controller合在一起的作用。<br>1)如果只是使用@RestController注解Controller，则Controller中的方法无法返回jsp页面，配置的视图解析器InternalResourceViewResolver不起作用，返回的内容就是Return 里的内容。<br>例如：本来应该到success.jsp页面的，则其显示success.<br>2)如果需要返回到指定页面，则需要用 @Controller配合视图解析器InternalResourceViewResolver才行。<br>3)如果需要返回JSON，XML或自定义mediaType内容到页面，则需要在对应的方法上加上@ResponseBody注解。</p>
<h3 id="部署到JavaEE容器"><a href="#部署到JavaEE容器" class="headerlink" title="部署到JavaEE容器"></a>部署到JavaEE容器</h3><p>修改启动类，继承 SpringBootServletInitializer 并重写 configure 方法</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">public class Application extends SpringBootServletInitializer&#123;</span><br><span class="line"></span><br><span class="line">    private static final Logger logger = LoggerFactory.getLogger(SpringBootSampleApplication.class);</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    protected SpringApplicationBuilder configure(SpringApplicationBuilder builder) &#123;</span><br><span class="line">        return builder.sources(this.getClass());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>修改pom文件中jar 为 war</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- &lt;packaging&gt;jar&lt;/packaging&gt; --&gt;</span><br><span class="line">&lt;packaging&gt;war&lt;/packaging&gt;</span><br></pre></td></tr></table></figure>
<p>修改pom，排除tomcat插件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">            &lt;exclusions&gt;</span><br><span class="line">                &lt;exclusion&gt;</span><br><span class="line">                    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                    &lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;</span><br><span class="line">                &lt;/exclusion&gt;</span><br><span class="line">            &lt;/exclusions&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p>最后，打包部署到容器。</p>
<p>打包排除</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">    &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;maven-jar-plugin&lt;/artifactId&gt;</span><br><span class="line">    &lt;configuration&gt;</span><br><span class="line">        &lt;excludes&gt;</span><br><span class="line">            &lt;exclude&gt;**/static/**&lt;/exclude&gt;</span><br><span class="line">            &lt;exclude&gt;**/templates/**&lt;/exclude&gt;</span><br><span class="line">        &lt;/excludes&gt;</span><br><span class="line">    &lt;/configuration&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<h3 id="指定外部的配置文件"><a href="#指定外部的配置文件" class="headerlink" title="指定外部的配置文件"></a>指定外部的配置文件</h3><p>有些系统，关于一些数据库或其他第三方账户等信息，由于安全问题，其配置并不会提前配置在项目中暴露给开发人员。<br>对于这种情况，我们在运行程序的时候，可以通过参数指定一个外部配置文件。<br>以 itstyle.jar 为例，方法如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar itstyle.jar --spring.config.location=/opt/config/application.properties</span><br></pre></td></tr></table></figure>
<h3 id="创建脚本"><a href="#创建脚本" class="headerlink" title="创建脚本"></a>创建脚本</h3><p>为了在linux下方便启动，停止项目<br>start.sh：</p>
<p>#!/bin/sh</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">nohup java -jar $1  --server.port=$2  --spring.profiles.active=prod &amp;</span><br><span class="line"></span><br><span class="line">echo &apos;Start Success!&apos;</span><br><span class="line">执行方式：start.sh itstyle.jar 8886</span><br><span class="line">$1和$2分别为传入的参数itstyle.jar 和 8886</span><br><span class="line"></span><br><span class="line">stop.sh：</span><br><span class="line"></span><br><span class="line">#!/bin/sh</span><br><span class="line"></span><br><span class="line">tpid=`ps -ef|grep $1|grep -v grep|grep -v kill|awk &apos;&#123;print $2&#125;&apos;`</span><br><span class="line">if [ &quot;$&#123;tpid&#125;&quot; ]; then</span><br><span class="line">	echo &apos;Stop Process...&apos;</span><br><span class="line">	kill -15 $tpid</span><br><span class="line">fi</span><br><span class="line">sleep 3</span><br><span class="line">tpid=`ps -ef|grep $1|grep -v grep|grep -v kill|awk &apos;&#123;print $2&#125;&apos;`</span><br><span class="line">if [ &quot;$&#123;tpid&#125;&quot; ]; then</span><br><span class="line">	echo &apos;Kill Process!&apos;</span><br><span class="line">	kill -9 $tpid</span><br><span class="line">else</span><br><span class="line">	echo &apos;Stop Success!&apos;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-07T08:01:58.000Z" itemprop="datePublished">2019-11-07</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-param" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/07/param/">SpringBoot 2.0 开发案例之参数传递的正确姿势</a>
  

      </h3>
      <div class="repo-list-description">
        
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p> 最近在进行SpringBoot2.0进行项目开发的过程发现，SpringBoot提供了丰富的参数传递的注解。于是在空闲的时间，整理了关于SpringBoot在开发实际案例时正确的传参姿势。希望能够帮到大家。希望大家能够在下方评论交流，希望得到大牛的指点！</p>
<h3 id="传递"><a href="#传递" class="headerlink" title="传递"></a>传递</h3><p><strong>用户登录</strong></p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">var param = &#123;</span><br><span class="line">    &quot;username&quot;: &quot;admin&quot;,</span><br><span class="line">    &quot;password&quot;: &quot;admin&quot;</span><br><span class="line">&#125;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &quot;/sys/login&quot;,</span><br><span class="line">    data: param,</span><br><span class="line">    type: &quot;post&quot;,</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>后端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(&quot;/sys&quot;)</span><br><span class="line">public class LoginController &#123;</span><br><span class="line"></span><br><span class="line">    private static final Logger logger = LoggerFactory.getLogger(LoginController.class);</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * 登录</span><br><span class="line">     */</span><br><span class="line">    @PostMapping(&quot;/login&quot;)</span><br><span class="line">    public Result login(String username, String password)&#123;</span><br><span class="line">        logger.info(&quot;用户登录&quot;+username);</span><br><span class="line">        //业务逻辑</span><br><span class="line">        return Result.ok(&quot;登录成功&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong>当然，你也可以这么实现，@RequestParam(value=”username”, required=true) ，required默认为 true，如果前台不传递此参数，后台会报错。如果设置为 false，如果不传，默认为 null。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 登录</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;/login&quot;)</span><br><span class="line">public Result login(@RequestParam(value=&quot;username&quot;, required=true) String username,</span><br><span class="line">                    @RequestParam(value=&quot;password&quot;, required=true) String password)&#123;</span><br><span class="line">    logger.info(&quot;用户登录&quot;+username);</span><br><span class="line">    //业务逻辑</span><br><span class="line">    return Result.ok(&quot;登录成功&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>用户注册</strong></p>
<p>前端代码，提交方式与登录基本保持一致。</p>
<p>后端代码：</p>
<p>用一个对象来接收前台参数，一般后端有对应的实体类。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 注册</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;/register&quot;)</span><br><span class="line">public Result register(SysUser user)&#123;</span><br><span class="line">    logger.info(&quot;&#123;&#125;，用户注册&quot;,user.getUsername());</span><br><span class="line">    //业务逻辑</span><br><span class="line">    return Result.ok(&quot;注册成功&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>多参数无实体一</p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var param = &#123;</span><br><span class="line">    &quot;title&quot;: &quot;爪哇笔记&quot;,</span><br><span class="line">    &quot;content&quot;: &quot;一个有趣的公众号&quot;,</span><br><span class="line">    &quot;author&quot;: &quot;小柒2012&quot;</span><br><span class="line">&#125;</span><br><span class="line">param = JSON.stringify(param);</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &quot;/sys/multiParameter&quot;,</span><br><span class="line">    data: param,</span><br><span class="line">    type: &quot;post&quot;,</span><br><span class="line">    contentType: &quot;application/json&quot;,</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>后端实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 多参数</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;/multiParameter&quot;)</span><br><span class="line">public Result register(@RequestBody Map&lt;String,Object&gt; map)&#123;</span><br><span class="line">    logger.info(&quot;多参数传递:&#123;&#125;,&#123;&#125;&quot;,map.get(&quot;title&quot;),map.get(&quot;content&quot;));</span><br><span class="line">    //业务逻辑</span><br><span class="line">    return Result.ok(&quot;接收多参数成功&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>多参数无实体二</p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">var param = &#123;</span><br><span class="line">    &quot;title&quot;: &quot;爪哇笔记&quot;,</span><br><span class="line">    &quot;content&quot;: &quot;一个有趣的公众号&quot;,</span><br><span class="line">    &quot;author&quot;: &quot;小柒2012&quot;</span><br><span class="line">&#125;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &quot;/sys/multiParameter&quot;,</span><br><span class="line">    data: param,</span><br><span class="line">    type: &quot;post&quot;,</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>后端实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 多参数</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;/multiParameter&quot;)</span><br><span class="line">public Result register(@RequestParam Map&lt;String,Object&gt; map)&#123;</span><br><span class="line">    logger.info(&quot;多参数传递:&#123;&#125;,&#123;&#125;&quot;,map.get(&quot;title&quot;),map.get(&quot;content&quot;));</span><br><span class="line">    //业务逻辑</span><br><span class="line">    return Result.ok(&quot;接收多参数成功&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>传递数组</p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">var param = &#123;</span><br><span class="line">    &quot;ids&quot;: [1, 2, 3]</span><br><span class="line">&#125;</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &quot;/sys/array&quot;,</span><br><span class="line">    data: param,</span><br><span class="line">    type: &quot;post&quot;,</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>后端实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 数组</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;array&quot;)</span><br><span class="line">public Result array(@RequestParam(value = &quot;ids[]&quot;) Integer[] ids) &#123;</span><br><span class="line">    logger.info(&quot;数据&#123;&#125;&quot;, Arrays.asList(ids));</span><br><span class="line">    //业务逻辑</span><br><span class="line">    return Result.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传递集合</p>
<p>前端代码与传递数组保持一致。</p>
<p>后端实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 集合</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;array&quot;)</span><br><span class="line">public Result array(@RequestParam(value = &quot;ids[]&quot;) List&lt;Integer&gt; ids) &#123;</span><br><span class="line">    logger.info(&quot;数据&#123;&#125;&quot;, ids.toString());</span><br><span class="line">    //业务逻辑</span><br><span class="line">    return Result.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>传递集合实体对象</p>
<p>比如，后端想接收一个实体对象集合 List<SysUser></p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">var list = [];</span><br><span class="line">list.push(&#123;</span><br><span class="line">    &quot;username&quot;: &quot;小柒2012&quot;,</span><br><span class="line">    &quot;mobile&quot;: &quot;17762288888&quot;</span><br><span class="line">&#125;);</span><br><span class="line">list.push(&#123;</span><br><span class="line">    &quot;username&quot;: &quot;小柒2013&quot;,</span><br><span class="line">    &quot;mobile&quot;: &quot;17762289999&quot;</span><br><span class="line">&#125;);</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &quot;/sys/listUser&quot;,</span><br><span class="line">    data: JSON.stringify(list),</span><br><span class="line">    type: &quot;post&quot;,</span><br><span class="line">    contentType: &quot;application/json&quot;,</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>后端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 爪哇笔记</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;listUser&quot;)</span><br><span class="line">public Result listUser(@RequestBody List&lt;SysUser&gt; list) &#123;</span><br><span class="line">   logger.info(&quot;数据&#123;&#125;&quot;, list.size());</span><br><span class="line">   list.forEach(user-&gt;&#123;</span><br><span class="line">      //输出实体对象</span><br><span class="line">      System.out.println(user.getUsername());</span><br><span class="line">   &#125;);</span><br><span class="line">   //业务逻辑</span><br><span class="line">   return Result.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>传递集合实体对象一对多</p>
<p>比如，一个用户有多个角色 List<SysRole> roleList</p>
<p>前端代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">var roleList = [];</span><br><span class="line">roleList.push(&#123;</span><br><span class="line">    &quot;roleSign&quot;: &quot;admin&quot;,</span><br><span class="line">    &quot;roleName&quot;: &quot;管理员&quot;</span><br><span class="line">&#125;);</span><br><span class="line">roleList.push(&#123;</span><br><span class="line">    &quot;roleSign&quot;: &quot;user&quot;,</span><br><span class="line">    &quot;roleName&quot;: &quot;普通用户&quot;</span><br><span class="line">&#125;);</span><br><span class="line">var list = [];</span><br><span class="line">var user = &#123;</span><br><span class="line">    &quot;username&quot;: &quot;小柒2012&quot;,</span><br><span class="line">    &quot;mobile&quot;: &quot;17762288888&quot;</span><br><span class="line">&#125;;</span><br><span class="line">user.roleList = roleList;</span><br><span class="line">list.push(user);</span><br><span class="line">$.ajax(&#123;</span><br><span class="line">    url: &quot;/sys/listUserRole&quot;,</span><br><span class="line">    data: JSON.stringify(list),</span><br><span class="line">    type: &quot;post&quot;,</span><br><span class="line">    contentType: &quot;application/json&quot;,</span><br><span class="line">    dataType: &quot;json&quot;,</span><br><span class="line">    success: function(data) &#123;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>
<p>后端实现：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * 爪哇笔记</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@PostMapping(&quot;listUserRole&quot;)</span><br><span class="line">public Result listUserRole(@RequestBody List&lt;SysUser&gt; list) &#123;</span><br><span class="line">    logger.info(&quot;数据&#123;&#125;&quot;, list.size());</span><br><span class="line">    list.forEach(user-&gt;&#123;</span><br><span class="line">        List&lt;SysRole&gt; roleList = user.getRoleList();</span><br><span class="line">        roleList.forEach(role-&gt;&#123;</span><br><span class="line">          System.out.println(role.getRoleName());</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;);</span><br><span class="line">    return Result.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="炒鸡复杂"><a href="#炒鸡复杂" class="headerlink" title="炒鸡复杂"></a>炒鸡复杂</h3><p>传输对象有实体，有集合，有各种类型的数据，这时候最简单的方式就是传递 Key-Value 结构的 JSON 字符串，后台 Map 类型接收，然后通过FastJson的 JSON.parseObject() 和 JSON.parseArray() 方法转化为对应的实体或者集合。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String user = parseMap.get(&quot;user&quot;).toString();</span><br><span class="line">SysUser sysUser = JSON.parseObject(user,SysUser.class);</span><br><span class="line">String contractClause = parseMap.get(&quot;rules&quot;).toString();</span><br><span class="line">List&lt;Rule&gt; ruleList = JSON.parseArray(contractClause,Rule.class);</span><br></pre></td></tr></table></figure>
<p>RESTful 风格</p>
<p>比如，访问某篇文章：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">  * https://blog.52itstyle.vip</span><br><span class="line">  */</span><br><span class="line">@GetMapping(&quot;article/&#123;id&#125;&quot;)</span><br><span class="line">public void article(@PathVariable(&quot;id&quot;) String id) &#123;</span><br><span class="line">    logger.info(&quot;文章&#123;&#125;&quot;,id);</span><br><span class="line">    //业务逻辑</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>原则<br><strong>记住一下几点：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">@RequestBody 注解，必须与 contentType 类型application/json配合使用。</span><br><span class="line">@RequestParam 注解，必须与 contentType 类型application/x-www-form-urlencoded配合使用，其为默认类型。</span><br><span class="line">JSON.stringify() 把对象类型转换为字符串类型，一般配合 @RequestBody 注解和contentType 类型application/json使用。</span><br></pre></td></tr></table></figure>

<h3 id="扩展"><a href="#扩展" class="headerlink" title="扩展"></a>扩展</h3><p><strong>在以上只涉及了两种 contentType 类型，其实还有两种常见的类型：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">multipart/form-data</span><br></pre></td></tr></table></figure>
<p><strong>一般用于表单文件上传，必须让 form 的 enctype 等于这个值。</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;form action=&quot;/upload&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">  &lt;input type=&quot;text&quot; name=&quot;description&quot; value=&quot;爪哇笔记，一个神奇的公众号&quot;&gt;</span><br><span class="line">  &lt;input type=&quot;file&quot; name=&quot;myFile&quot;&gt;</span><br><span class="line">  &lt;button type=&quot;submit&quot;&gt;Submit&lt;/button&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">text/xml</span><br></pre></td></tr></table></figure>

<p>做过微信支付的小伙伴一定会知道，微信就喜欢用这种方式，去年还发生过 XXE 漏洞，在解析XML文档时，解析器通过 ENTITY 扩展的功能，读取本地受保护的文件，并且使用扩展功能将受保护的文件发送到远程地址。</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-07T07:42:30.000Z" itemprop="datePublished">2019-11-07</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-springboot-jpa" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/07/springboot-jpa/">SpringBoot开发案例之整合Spring-data-jpa</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>即使你是天才，如果你不努力，你也会被其它人超越。</p>
</blockquote>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ibG9nLjUyaXRzdHlsZS52aXAvdXNyL3VwbG9hZHMvMjAxNy8wNy8xMjQ4NTc0MzguanBn?x-oss-process=image/format,png#pic_center" alt=""></p>
<h3 id="扯淡-我们是认真的"><a href="#扯淡-我们是认真的" class="headerlink" title="扯淡!我们是认真的"></a>扯淡!我们是认真的</h3><p>  扯了那么多篇SpringBoot的相关案例，基本每行代码都是博主纯手工编写，附代码案例，懂Maven和Git的小伙伴必须可以手到擒来。<br>SpringBoot使得开发变的更加简洁，快速，当然被封装的越来越深。此时你就要引入越来越多的第三方工具类，虽然你可以把搭建好的项目运行起来，却无法理解是怎么跑起来的。有些人带着疑惑查阅文档，阅读源码，多年以后便成了大牛；有些人不求甚解，能跑就行，就这样干了N年CURD。<br>俗话说的好，燕雀安知鸿鹄之志哉？然子非鱼又焉知鱼之乐？curd并快乐着。每个人，都会有自己的成长轨迹，或平凡或精彩或或或或，快使用双节棍，嘿嘿哈嘿。</p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>好了，淡就扯这么多，今天与大家分享一款”超薄”的数据访问层框架Spring-data-jpa，依赖Hibernate，对Hibernate有一定的基础，可以更好的理解。</p>
<h3 id="什么是spring-data"><a href="#什么是spring-data" class="headerlink" title="什么是spring-data"></a>什么是spring-data</h3><p>为了简化程序与数据库交互的代码，spring提供了一个现成的dao层框架，spring家族提供的spring-data适用于关系型数据库和nosql数据库。比如之前我们讲解的案例：<br>SpringBoot开发案例之整合mongoDB，当然还有Spring Data Solr，Spring Data Redis以及我们今天要分享的Spring Data JPA。</p>
<p>详解的可以参考:<img src="https://spring.io/projects/spring-data" alt="官网"></p>
<h3 id="什么是JPA"><a href="#什么是JPA" class="headerlink" title="什么是JPA"></a>什么是JPA</h3><p>JPA全称为Java持久性API（Java Persistence API），JPA是java EE 5标准之一，是一个ORM规范，由厂商来实现该规范，目前有hibernate、OpenJPA、TopLink、EclipseJPA等实现。</p>
<h3 id="如何使用JPA"><a href="#如何使用JPA" class="headerlink" title="如何使用JPA"></a>如何使用JPA</h3><p><strong>查询</strong></p>
<p>1.查询所有数据 findAll()<br>2.分页查询 findAll(new PageRequest(0, 2))<br>3.根据id查询 findOne()<br>4.根据实体类属性查询： findByProperty (type Property); 例如：findByAge(int age);<br>5.排序： findAll(sort )<br>6.Sort sort = new Sort(Sort.Direction.DESC, “age”).and (new Sort(Sort.Direction.DESC, “id”));<br>7.条件查询 and/or/findByAgeLessThan/LessThanEqual 等，<br>例如： findByUsernameAndPassword(String username , String password)<br>8.总数 查询 count() 或者 根据某个属性的值查询总数countByAge(int age);<br>9.是否存在某个id exists()<br>10.修改，删除，新增</p>
<p>1.新增：直接使用 save(T) 方法<br>2.删除： delete() 或者 deleteByProperty 例如：deleteByAge(int age) ;<br>3.更新：<br>@Modifying<br>@Query(“update Customer u set u.age = ?1 where u.id = ?2”)<br>int update(int age1 , long id);</p>
<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ibG9nLjUyaXRzdHlsZS52aXAvdXNyL3VwbG9hZHMvMjAxNy8wNy8yOTI3ODM3NzY4LnBuZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<h3 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h3><p><strong>pom.xml(部分代码，详见源码)：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p><strong>application.properties：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 项目contextPath</span><br><span class="line">server.context-path=/jpa</span><br><span class="line"># 服务端口</span><br><span class="line">server.port=8080</span><br><span class="line"># session最大超时时间(分钟)，默认为30</span><br><span class="line">server.session-timeout=60</span><br><span class="line"># 该服务绑定IP地址，启动服务器时如本机不是该IP地址则抛出异常启动失败，只有特殊需求的情况下才配置</span><br><span class="line">#server.address=192.168.1.66</span><br><span class="line"> </span><br><span class="line"># tomcat最大线程数，默认为200</span><br><span class="line">server.tomcat.max-threads=100</span><br><span class="line"># tomcat的URI编码</span><br><span class="line">server.tomcat.uri-encoding=UTF-8</span><br><span class="line"> </span><br><span class="line">#注意中文乱码</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?characterEncoding=utf-8</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"># Specify the DBMS</span><br><span class="line">spring.jpa.database = MYSQL</span><br><span class="line"># Show or not log for each sql query</span><br><span class="line">spring.jpa.show-sql = true</span><br><span class="line"># DDL mode. This is actually a shortcut for the &quot;hibernate.hbm2ddl.auto&quot; property. Default to &quot;create-drop&quot; when using an embedded database, &quot;none&quot; otherwise.</span><br><span class="line">spring.jpa.hibernate.ddl-auto = update</span><br><span class="line"># Hibernate 4 naming strategy fully qualified name. Not supported with Hibernate 5.</span><br><span class="line">spring.jpa.hibernate.naming.strategy = org.hibernate.cfg.ImprovedNamingStrategy</span><br><span class="line"># stripped before adding them to the entity manager)</span><br><span class="line">spring.jpa.properties.hibernate.dialect = org.hibernate.dialect.MySQL5Dialect</span><br></pre></td></tr></table></figure>
<p>spring.jpa.properties.hibernate.hbm2ddl.auto是hibernate的配置属性，其主要作用是：自动创建、更新、验证数据库表结构。该参数的几种配置如下：</p>
<p>1.create：每次加载hibernate时都会删除上一次的生成的表，然后根据你的model类再重新来生成新表，哪怕两次没有任何改变也要这样执行，这就是导致数据库表数据丢失的一个重要原因。<br>2.create-drop：每次加载hibernate时根据model类生成表，但是sessionFactory一关闭,表就自动删除。<br>3.update：最常用的属性，第一次加载hibernate时根据model类会自动建立起表的结构（前提是先建立好数据库），以后加载hibernate时根据model类自动更新表结构，即使表结构改变了但表中的行仍然存在不会删除以前的行。要注意的是当部署到服务器后，表结构是不会被马上建立起来的，是要等应用第一次运行起来后才会。<br>4.validate：每次加载hibernate时，验证创建数据库表结构，只会和数据库中的表进行比较，不会创建新表，但是会插入新值。<br>实体类 User.java:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package com.itstyle.jpa.model;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line">/**</span><br><span class="line"> * 用户实体(此处注意引用的注解包为javax.persistence*下面的)</span><br><span class="line"> * 创建者 科帮网</span><br><span class="line"> * 创建时间    2017年7月25日</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">@Entity</span><br><span class="line">@Table(name = &quot;sys_user&quot;)</span><br><span class="line">public class User implements Serializable&#123;</span><br><span class="line">    private static final long serialVersionUID = 1L;</span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue(strategy = GenerationType.AUTO)</span><br><span class="line">    @Column(name = &quot;id&quot;, nullable = false)</span><br><span class="line">    private Long id;</span><br><span class="line">    @Column(nullable = false, name = &quot;name&quot;)</span><br><span class="line">    private String name;</span><br><span class="line">    @Column(nullable = false, name = &quot;age&quot;)</span><br><span class="line">    private Integer age;</span><br><span class="line">    --- 省略 get set 方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>数据操作UserRepository.java:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 数据操作层</span><br><span class="line"> * 创建者 科帮网</span><br><span class="line"> * 创建时间    2017年7月25日</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">public interface UserRepository extends JpaRepository&lt;User, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    User findByName(String name);</span><br><span class="line">    </span><br><span class="line">    User findByAge(Integer age);</span><br><span class="line"></span><br><span class="line">    User findByNameAndAge(String name, Integer age);</span><br><span class="line">    </span><br><span class="line">    List&lt;User&gt; findByNameLike(String name);</span><br><span class="line"></span><br><span class="line">    @Query(&quot;from User u where u.name=:name&quot;)</span><br><span class="line">    User findUser(@Param(&quot;name&quot;) String name);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>小伙伴没有没有发现，我们只是定义了一个方法而已，怎么就这么奇妙的实现的对应功能？其实这是Spring-data-jpa的新特性，通过解析方法名创建查询。更多解析说明如下：</p>
<p>And =&gt; 等价于 SQL 中的 and 关键字 例如：findByUsernameAndPassword(String user, Striang pwd)；<br>Or =&gt; 等价于 SQL 中的 or 关键字，例如：findByUsernameOrAddress(String user, String addr)；<br>Between =&gt; 等价于 SQL 中的 between 关键字，例如：SalaryBetween(int max, int min)；<br>LessThan =&gt; 等价于 SQL 中的 “&lt;”，例如： findBySalaryLessThan(int max)；<br>GreaterThan =&gt; 等价于 SQL 中的”&gt;”，例如： findBySalaryGreaterThan(int min)；<br>IsNull =&gt; 等价于 SQL 中的 “is null”，例如： findByUsernameIsNull()；<br>IsNotNull =&gt; 等价于 SQL 中的 “is not null”，例如： findByUsernameIsNotNull()；<br>NotNull=&gt; 与 IsNotNull 等价；<br>Like =&gt; 等价于 SQL 中的 “like”，例如： findByUsernameLike(String user)；<br>NotLike =&gt; 等价于 SQL 中的 “not like”，例如： findByUsernameNotLike(String user)；<br>OrderBy =&gt; 等价于 SQL 中的 “order by”，例如： findByUsernameOrderBySalaryAsc(String user)；<br>Not =&gt; 等价于 SQL 中的 “！ =”，例如： findByUsernameNot(String user)；<br>In =&gt; 等价于 SQL 中的 “in”，例如： findByUsernameIn(Collection<String> userList) ，方法的参数可以是 Collection 类型，也可以是数组或者不定长参数；<br>NotIn =&gt; 等价于 SQL 中的 “not in”，例如： findByUsernameNotIn(Collection<String> userList) ，方法的参数可以是 Collection 类型，也可以是数组或者不定长参数；<br>创建一个按单字段排序的Sort对象: new Sort(Sort.Direction.DESC, “description”).and(new Sort(Sort.Direction.ASC, “id”))</p>
<p>最终测试类SpringbootJpaApplication.java:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package com.itstyle.jpa;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.boot.CommandLineRunner;</span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">import com.itstyle.jpa.model.User;</span><br><span class="line">import com.itstyle.jpa.repository.UserRepository;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class SpringbootJpaApplication implements CommandLineRunner &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(SpringbootJpaApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run(String... args) throws Exception &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            User user = new User();</span><br><span class="line">            user.setName(&quot;张三&quot;);</span><br><span class="line">            user.setAge(20);</span><br><span class="line">            userRepository.save(user);</span><br><span class="line">            List&lt;User&gt; u = userRepository.findByNameLike(&quot;%张三%&quot;);</span><br><span class="line">            System.out.println(u.size());</span><br><span class="line">            User  us =  userRepository.findByAge(20);</span><br><span class="line">            System.out.println(us.getAge());</span><br><span class="line">            us =  userRepository.findByName(&quot;这是你干&quot;);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="偶遇问题"><a href="#偶遇问题" class="headerlink" title="偶遇问题"></a>偶遇问题</h3><p>No identifier specified for entity:</p>
<p>检查一下包是否引入正确，引入一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import javax.persistence.*;</span><br></pre></td></tr></table></figure>
<p>中文乱码问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?characterEncoding=utf-8</span><br></pre></td></tr></table></figure>
<p>在高版本mysql中需要指定是否进行SSL连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?characterEncoding=utf-8&amp;useSSL=false</span><br></pre></td></tr></table></figure>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-07T07:28:42.000Z" itemprop="datePublished">2019-11-07</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-about-servlet" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/06/about-servlet/">Spring Boot 优雅的入门篇</a>
  

      </h3>
      <div class="repo-list-description">
        
          <p><img src="http://image.tengj.top/spring.jpg#pic_center" alt="SpringBoot"></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Spring一直是很火的一个开源框架，在过去的一段时间里，Spring Boot在社区中热度一直很高，所以决定花时间来了解和学习，为自己做技术储备。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>首先声明，Spring Boot不是一门新技术，所以不用紧张。从本质上来说，Spring Boot就是Spring,它做了那些没有它你也会去做的Spring Bean配置。它使用“习惯优于配置”（项目中存在大量的配置，此外还内置了一个习惯性的配置，让你无需手动进行配置）的理念让你的项目快速运行起来。使用Spring Boot很容易创建一个独立运行（运行jar,内嵌Servlet容器）、准生产级别的基于Spring框架的项目，使用Spring Boot你可以不用或者只需要很少的Spring配置。</p>
<h3 id="Spring-Boot精要"><a href="#Spring-Boot精要" class="headerlink" title="Spring Boot精要"></a>Spring Boot精要</h3><p>Spring将很多魔法带入了Spring应用程序的开发之中，其中最重要的是以下四个核心。<br>1.自动配置：针对很多Spring应用程序常见的应用功能，Spring Boot能自动提供相关配置<br>2.起步依赖：告诉Spring Boot需要什么功能，它就能引入需要的库。<br>3.命令行界面：这是Spring Boot的可选特性，借此你只需写代码就能完成完整的应用程序，无需传统项目构建。<br>4.Actuator：让你能够深入运行中的Spring Boot应用程序，一探究竟。</p>
<h3 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h3><p>目前Spring Boot正式版为1.5.1.RELEASE默认情况下，Spring Boot 1.5.1.RELEASE需要Java 7和Spring Framework 4.3.6.RELEASE或更高版本,你也可以使用Spring Boot with Java 6和一些额外的配置（不建议）,使用Maven（3.2+）或Gradle 2（2.9或更高版本）和3来构建。</p>
<blockquote>
<p>虽然你可以使用Java 6或7的Spring Boot，但我们通常推荐Java 8</p>
</blockquote>
<h3 id="优雅的Web入门开发"><a href="#优雅的Web入门开发" class="headerlink" title="优雅的Web入门开发"></a>优雅的Web入门开发</h3><p>没有比较就没有伤害，让我们先看看传统Spring MVC开发一个简单的Hello World Web应用程序，你应该做什么，我能想到一些基本的需求。<br>1.一个项目结构，其中有一个包含必要依赖的Maven或者Gradle构建文件，最起码要有Spring MVC和Servlet API这些依赖。<br>2.一个web.xml文件（或者一个WebApplicationInitializer实现），其中声明了Spring的DispatcherServlet。<br>3.一个启动了Spring MVC的Spring配置<br>4.一个控制器类，以“hello World”相应HTTP请求。<br>5.一个用于部署应用程序的Web应用服务器，比如Tomcat。<br>最让人难以接受的是，这份清单里面只有一个东西是和Hello World功能相关的，即控制器，剩下的都是Spring开发的Web应用程序必需的通用模板。<br>接下来看看Spring Boot如何搞定？<br>很简单，我仅仅只需要非常少的几个配置就可以迅速方便的搭建起来一套web项目</p>
<h3 id="初始化Spring-Boot项目"><a href="#初始化Spring-Boot项目" class="headerlink" title="初始化Spring Boot项目"></a>初始化Spring Boot项目</h3><p>构建一个Sping Boot的Maven项目，强烈推荐Spring Initializr,它从本质上来说就是一个Web应用程序，它能为你生成Spring Boot项目结构。<br>Spring Initializr有几种用法：</p>
<ul>
<li>通过Web界面使用</li>
</ul>
<p>1.访问：(<a href="http://start.spring.io/" target="_blank" rel="noopener">http://start.spring.io/</a>)<br>2.选择构建工具Maven Project、Spring Boot版本1.5.1以及一些工程基本信息，可参考下图所示：<br><img src="http://image.tengj.top/springboot1-1.png#pic_center" alt=""><br>3.点击Generate Project下载项目压缩包<br>4.导入到你的工程，如果是IDEA，则需要：<br>      a.菜单中选择File–&gt;New–&gt;Project from Existing Sources…<br>      b.选择解压后的项目文件夹，点击OK<br>      c.点击Import project from external model并选择Maven，点击Next到底为止。<br>      d.若你的环境有多个版本的JDK，注意到选择Java SDK的时候请选择Java 7以上的版本</p>
<ul>
<li>通过IntelliJ IDEA使用(个人推荐)IntelliJ IDEA是非常流行的IDE，IntelliJ IDEA 14.1已经支持Spring Boot了。<br>创建Spring Boot操作步骤如下：</li>
</ul>
<p>1.在File菜单里面选择 New &gt; Project,然后选择Spring Initializr，接着如下图一步步操作即可。<br><img src="http://image.tengj.top/springboot1-2.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-3.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-4.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-5.png#pic_center" alt=""></p>
<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>根据上面的操作已经初始化了一个Spring Boot的框架了，项目结构如下：<br><img src="http://image.tengj.top/springboot1-6.png#pic_center" alt=""><br>如你所见，项目里面基本没有代码，除了几个空目录外，还包含如下几样东西。</p>
<ul>
<li>pom.xml：Maven构建说明文件。</li>
<li>Chapter1Application.java：一个带有main()方法的类，用于启动应用程序（关键）。</li>
<li>Chapter1ApplicationTests.java：一个空的Junit测试类，它加载了一个使用Spring Boot字典配置功能的Spring应用程序上下文。</li>
<li>application.properties：一个空的properties文件，你可以根据需要添加配置属性。<h3 id="解析pom-xml文件"><a href="#解析pom-xml文件" class="headerlink" title="解析pom.xml文件"></a>解析pom.xml文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;com.dudu&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;chapter1&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;packaging&gt;jar&lt;/packaging&gt;</span><br><span class="line"></span><br><span class="line">    &lt;name&gt;chapter1&lt;/name&gt;</span><br><span class="line">    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class="line">        &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
可以看出，有几个配置是不大一样的,我们挑几个重要的说说，要是客观不想过早的了解这些，自行跳过这一知识点即可。<h3 id="Spring-Boot父级依赖"><a href="#Spring-Boot父级依赖" class="headerlink" title="Spring Boot父级依赖"></a>Spring Boot父级依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;/parent&gt;</span><br></pre></td></tr></table></figure>
 这块配置就是Spring Boot父级依赖，有了这个，当前的项目就是Spring Boot项目了，spring-boot-starter-parent是一个特殊的starter,它用来提供相关的Maven默认依赖，使用它之后，常用的包依赖可以省去version标签。关于Spring Boot提供了哪些jar包的依赖，可查看C:\Users\用户.m2\repository\org\springframework\boot\spring-boot-dependencies\1.5.1.RELEASE\spring-boot-dependencies-1.5.1.RELEASE.pom<br>这里我就贴一点点意思意思，如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">        &lt;!-- Dependency versions --&gt;</span><br><span class="line">        &lt;activemq.version&gt;5.14.3&lt;/activemq.version&gt;</span><br><span class="line">        &lt;antlr2.version&gt;2.7.7&lt;/antlr2.version&gt;</span><br><span class="line">        &lt;appengine-sdk.version&gt;1.9.48&lt;/appengine-sdk.version&gt;</span><br><span class="line">        &lt;artemis.version&gt;1.5.2&lt;/artemis.version&gt;</span><br><span class="line">        &lt;aspectj.version&gt;1.8.9&lt;/aspectj.version&gt;</span><br><span class="line">        &lt;assertj.version&gt;2.6.0&lt;/assertj.version&gt;</span><br><span class="line">        &lt;atomikos.version&gt;3.9.3&lt;/atomikos.version&gt;</span><br><span class="line">        &lt;bitronix.version&gt;2.1.4&lt;/bitronix.version&gt;</span><br><span class="line">        &lt;caffeine.version&gt;2.3.5&lt;/caffeine.version&gt;</span><br><span class="line">        &lt;cassandra-driver.version&gt;3.1.3&lt;/cassandra-driver.version&gt;</span><br><span class="line">        &lt;classmate.version&gt;1.3.3&lt;/classmate.version&gt;</span><br><span class="line">        &lt;commons-beanutils.version&gt;1.9.3&lt;/commons-beanutils.version&gt;</span><br><span class="line">        &lt;commons-collections.version&gt;3.2.2&lt;/commons-collections.version&gt;</span><br><span class="line">        &lt;spring-data-releasetrain.version&gt;Ingalls-RELEASE&lt;/spring-data-releasetrain.version&gt;</span><br><span class="line">        ......</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>
如果你不想使用某个依赖默认的版本，您还可以通过覆盖自己的项目中的属性来覆盖各个依赖项，例如，要升级到另一个Spring Data版本系列，您可以将以下内容添加到pom.xml中。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;spring-data-releasetrain.version&gt;Fowler-SR2&lt;/spring-data-releasetrain.version&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>
原本默认版本是Ingalls-RELEASE的（看上面最后一行有说明Ingalls-RELEASE），现在就使用Fowler-SR2版本了，简单吧。<br>并不是每个人都喜欢继承自spring-boot-starter-parent POM。您可能有您需要使用的自己的公司标准parent，或者您可能更喜欢显式声明所有的Maven配置。<br>如果你不想使用spring-boot-starter-parent，您仍然可以通过使用scope = import依赖关系来保持依赖关系管理：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">     &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;!-- Import dependency management from Spring Boot --&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>
该设置不允许您使用如上所述的属性(properties)覆盖各个依赖项，要实现相同的结果，您需要在spring-boot-dependencies项之前的项目的dependencyManagement中添加一个配置，例如，要升级到另一个Spring Data版本系列，您可以将以下内容添加到pom.xml中。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;!-- Override Spring Data release train provided by Spring Boot --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-data-releasetrain&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;Fowler-SR2&lt;/version&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>
<h3 id="起步依赖-spring-boot-starter-xx"><a href="#起步依赖-spring-boot-starter-xx" class="headerlink" title="起步依赖 spring-boot-starter-xx"></a>起步依赖 spring-boot-starter-xx</h3>Spring Boot提供了很多”开箱即用“的依赖模块，都是以spring-boot-starter-xx作为命名的。举个例子来说明一下这个起步依赖的好处，比如组装台式机和品牌机，自己组装的话需要自己去选择不同的零件，最后还要组装起来，期间有可能会遇到零件不匹配的问题。耗时又消力，而品牌机就好一点，买来就能直接用的，后续想换零件也是可以的。相比较之下，后者带来的效果更好点（这里就不讨论价格问题哈），起步依赖就像这里的品牌机，自动给你封装好了你想要实现的功能的依赖。就比如我们之前要实现web功能，引入了spring-boot-starter-web这个起步依赖。我们来看看spring-boot-starter-web到底依赖了哪些,如下图：<br><img src="http://image.tengj.top/springboot1-7.png#pic_center" alt=""><br>嘿嘿嘿，看来依赖了好多呢，如果让我自己弄估计要调半天，所以Spring Boot通过提供众多起步依赖降低项目依赖的复杂度。起步依赖本质上是一个Maven项目对象模型（Project Object Model，POM），定义了对其他库的传递依赖，这些东西加在一起即支持某项功能。很多起步依赖的命名都暗示了它们提供的某种或者某类功能。<h3 id="Spring-Boot-Maven插件"><a href="#Spring-Boot-Maven插件" class="headerlink" title="Spring Boot Maven插件"></a>Spring Boot Maven插件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">        &lt;plugin&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>1.上面的配置就是Spring Boot Maven插件，Spring Boot Maven插件提供了许多方便的功能：<br>把项目打包成一个可执行的超级JAR（uber-JAR）,包括把应用程序的所有依赖打入JAR文件内，并为JAR添加一个描述文件，其中的内容能让你用java -jar来运行应用程序。<br>2.搜索public static void main()方法来标记为可运行类。</p>
<h3 id="应用程序入口类"><a href="#应用程序入口类" class="headerlink" title="应用程序入口类"></a>应用程序入口类</h3><p>Chapter1Application是一个很关键的启动类，程序的入口就是这里,为了演示简单，我们不再新建控制类，而是直接在这个入口类中编写，添加@RestController以及index方法，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package com.dudu;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Chapter1Application &#123;</span><br><span class="line"></span><br><span class="line">	@RequestMapping(&quot;/&quot;)</span><br><span class="line">	public String index()&#123;</span><br><span class="line">		return &quot;Hello Spring Boot&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		SpringApplication.run(Chapter1Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.@SpringBootApplication是Sprnig Boot项目的核心注解，主要目的是开启自动配置。后续讲解原理的时候再深入介绍。<br>2.main方法这是一个标准的Java应用的main的方法，主要作用是作为项目启动的入口。<br>3.@RestController注解等价于@Controller+@ResponseBody的结合，使用这个注解的类里面的方法都以json格式输出。</p>
<p><strong>最后，启动项目有三种方式</strong>：<br>1.Chapter1Application的main方法<br><img src="http://image.tengj.top/springboot1-8.png#pic_center" alt=""><br>2.使用命令 mvn spring-boot:run”在命令行启动该应用，IDEA中该命令在如下位置：<br><img src="http://image.tengj.top/springboot1-9.png#pic_center" alt=""><br>3.运行“mvn package”进行打包时，会打包成一个可以直接运行的 JAR 文件，使用“java -jar”命令就可以直接运行。<br><img src="http://image.tengj.top/springboot1-10.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-11.png#pic_center" alt=""><br>打开浏览器访问(<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a>), 你就能看到页面显示Hello Spring Boot效果了，一个简单的Web的项目就是如此简单。</p>
<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>虽然我上面讲解了那么多，但是实际开发步骤就是那么简单暴力，初始化一个Spring Boot，添加一个控制类，启动就能看到效果了。<br>本章作为入门Spring Boot的入门介绍，相关的需要理解的概念就只有这几点：</p>
<ul>
<li>Spring Boot父级依赖的概念</li>
<li>起步依赖 spring-boot-starter-xx的概念</li>
<li>应用入口类的作用</li>
</ul>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-06T04:54:15.000Z" itemprop="datePublished">2019-11-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-java" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/06/java/">Spring Boot 开发Web应用之Thymeleaf篇</a>
  

      </h3>
      <div class="repo-list-description">
        
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Web开发是我们平时开发中至关重要的，这里就来介绍一下Spring Boot对Web开发的支持。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>Spring Boot提供了spring-boot-starter-web为Web开发予以支持，spring-boot-starter-web为我们提供了嵌入的Tomcat以及Spring MVC的依赖。</p>
<h3 id="项目结构推荐"><a href="#项目结构推荐" class="headerlink" title="项目结构推荐"></a>项目结构推荐</h3><p>一个好的项目结构会让你开发少一些问题，特别是Spring Boot中启动类要放在root package下面，我的web工程项目结构如下：<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC0xLmpwZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>1.root package结构：com.dudu<br>2.应用启动类Application.java置于root package下，这样使用@ComponentScan注解的时候默认就扫描当前所在类的package<br>3.实体（Entity）置于com.dudu.domain包下<br>4.逻辑层（Service）置于com.dudu.service包下<br>5.controller层（web）置于com.dudu.controller层包下<br>6.static可以用来存放静态资源<br>7.templates用来存放默认的模板配置路径</p>
<h3 id="Spring-Web-MVC框架介绍"><a href="#Spring-Web-MVC框架介绍" class="headerlink" title="Spring Web MVC框架介绍"></a>Spring Web MVC框架介绍</h3><p>Spring Web MVC框架（通常简称为”Spring MVC”）是一个富”模型，视图，控制器”的web框架。<br>Spring MVC允许你创建特定的@Controller或@RestController beans来处理传入的HTTP请求。<br>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(value=&quot;/users&quot;)</span><br><span class="line">public class MyRestController &#123;</span><br><span class="line">@RequestMapping(value=&quot;/&#123;user&#125;&quot;, method=RequestMethod.GET)</span><br><span class="line">public User getUser(@PathVariable Long user) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">@RequestMapping(value=&quot;/&#123;user&#125;/customers&quot;, method=RequestMethod.GET)</span><br><span class="line">List&lt;Customer&gt; getUserCustomers(@PathVariable Long user) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">@RequestMapping(value=&quot;/&#123;user&#125;&quot;, method=RequestMethod.DELETE)</span><br><span class="line">public User deleteUser(@PathVariable Long user) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Spring-MVC自动配置"><a href="#Spring-MVC自动配置" class="headerlink" title="Spring MVC自动配置"></a>Spring MVC自动配置</h3><p>Spring Boot为Spring MVC提供适用于多数应用的自动配置功能。在Spring默认基础上，自动配置添加了以下特性：</p>
<p>1.引入ContentNegotiatingViewResolver和BeanNameViewResolver beans。<br>2.对静态资源的支持，包括对WebJars的支持。<br>3.自动注册Converter，GenericConverter，Formatter beans。<br>4.对HttpMessageConverters的支持。<br>5.自动注册MessageCodeResolver。<br>6.对静态index.html的支持。<br>7.对自定义Favicon的支持。<br>如果想全面控制Spring MVC，你可以添加自己的@Configuration，并使用@EnableWebMvc对其注解。如果想保留Spring Boot MVC的特性，并只是添加其他的MVC配置(拦截器，formatters，视图控制器等)，你可以添加自己的WebMvcConfigurerAdapter类型的@Bean（不使用@EnableWebMvc注解）,具体拦截器等配置后续文章会解析。</p>
<h3 id="静态文件"><a href="#静态文件" class="headerlink" title="静态文件"></a>静态文件</h3><p>默认情况下，Spring Boot从classpath下一个叫/static（/public，/resources或/META-INF/resources）的文件夹或从ServletContext根目录提供静态内容。这使用了Spring MVC的ResourceHttpRequestHandler，所以你可以通过添加自己的WebMvcConfigurerAdapter并覆写addResourceHandlers方法来改变这个行为（加载静态文件）。</p>
<p>在一个单独的web应用中，容器默认的servlet是开启的，如果Spring决定不处理某些请求，默认的servlet作为一个回退（降级）将从ServletContext根目录加载内容。大多数时候，这不会发生（除非你修改默认的MVC配置），因为Spring总能够通过DispatcherServlet处理请求。</p>
<p>此外，上述标准的静态资源位置有个例外情况是Webjars内容。任何在/webjars/**路径下的资源都将从jar文件中提供，只要它们以Webjars的格式打包。</p>
<p>注：如果你的应用将被打包成jar，那就不要使用src/main/webapp文件夹。尽管该文件夹是一个共同的标准，但它仅在打包成war的情况下起作用，并且如果产生一个jar，多数构建工具都会静悄悄的忽略它</p>
<h3 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h3><p>Spring Boot支持多种模版引擎包括：</p>
<p>1.FreeMarker<br>2.Groovy<br>3.Thymeleaf(官方推荐)<br>4.Mustache</p>
<p>JSP技术Spring Boot官方是不推荐的，原因有三：</p>
<p>1.tomcat只支持war的打包方式，不支持可执行的jar。<br>2.Jetty 嵌套的容器不支持jsp<br>3.Undertow<br>4.创建自定义error.jsp页面不会覆盖错误处理的默认视图，而应该使用自定义错误页面</p>
<p>当你使用上述模板引擎中的任何一个，它们默认的模板配置路径为：src/main/resources/templates。当然也可以修改这个路径，具体如何修改，可在后续各模板引擎的配置属性中查询并修改。</p>
<h3 id="Thymeleaf模板引擎"><a href="#Thymeleaf模板引擎" class="headerlink" title="Thymeleaf模板引擎"></a>Thymeleaf模板引擎</h3><p>Thymeleaf是一款用于渲染XML/XHTML/HTML5内容的模板引擎。类似JSP，Velocity，FreeMaker等，它也可以轻易的与Spring MVC等Web框架进行集成作为Web应用的模板引擎。与其它模板引擎相比，Thymeleaf最大的特点是能够直接在浏览器中打开并正确显示模板页面，而不需要启动整个Web应用。它的功能特性如下：</p>
<p>1.Spring MVC中@Controller中的方法可以直接返回模板名称，接下来Thymeleaf模板引擎会自动进行渲染<br>2.模板中的表达式支持Spring表达式语言（Spring EL)<br>3.表单支持，并兼容Spring MVC的数据绑定与验证机制<br>4.国际化支持<br> Spring官方也推荐使用Thymeleaf,所以本篇代码整合就使用Thymeleaf来整合。</p>
<h3 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC0yLmpwZw?x-oss-process=image/format,png#pic_center" alt=""><br>如图所示，spring-boot-starter-thymeleaf会自动包含spring-boot-starter-web，所以我们就不需要单独引入web依赖了。</p>
<h3 id="编写controller"><a href="#编写controller" class="headerlink" title="编写controller"></a>编写controller</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/learn&quot;)</span><br><span class="line">public class LearnResourceController &#123;</span><br><span class="line">@RequestMapping(&quot;/&quot;)</span><br><span class="line">public ModelAndView index()&#123;</span><br><span class="line">List&lt;LearnResouce&gt; learnList =new ArrayList&lt;LearnResouce&gt;();</span><br><span class="line">LearnResouce bean =new LearnResouce(&quot;官方参考文档&quot;,&quot;Spring Boot Reference Guide&quot;,&quot;http://docs.spring.io/spring-boot/docs/1.5.1.RELEASE/reference/htmlsingle/#getting-started-first-application&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;官方SpriongBoot例子&quot;,&quot;官方SpriongBoot例子&quot;,&quot;https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;龙国学院&quot;,&quot;Spring Boot 教程系列学习&quot;,&quot;http://www.roncoo.com/article/detail/125488&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;嘟嘟MD独立博客&quot;,&quot;Spring Boot干货系列 &quot;,&quot;http://tengj.top/&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;后端编程嘟&quot;,&quot;Spring Boot教程和视频 &quot;,&quot;http://www.toutiao.com/m1559096720023553/&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;程序猿DD&quot;,&quot;Spring Boot系列&quot;,&quot;http://www.roncoo.com/article/detail/125488&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;纯洁的微笑&quot;,&quot;Sping Boot系列文章&quot;,&quot;http://www.ityouknow.com/spring-boot&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;CSDN——小当博客专栏&quot;,&quot;Sping Boot学习&quot;,&quot;http://blog.csdn.net/column/details/spring-boot.html&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;梁桂钊的博客&quot;,&quot;Spring Boot 揭秘与实战&quot;,&quot;http://blog.csdn.net/column/details/spring-boot.html&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;林祥纤博客系列&quot;,&quot;从零开始学Spring Boot &quot;,&quot;http://412887952-qq-com.iteye.com/category/356333&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">ModelAndView modelAndView = new ModelAndView(&quot;/index&quot;);</span><br><span class="line">modelAndView.addObject(&quot;learnList&quot;, learnList);</span><br><span class="line">return modelAndView;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="编写html"><a href="#编写html" class="headerlink" title="编写html"></a>编写html</h3><p>引入依赖后就在默认的模板路径src/main/resources/templates下编写模板文件即可完成。这里我们新建一个index.html:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;learn Resources&lt;/title&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot;text-align: center;margin:0 auto;width: 1000px; &quot;&gt;</span><br><span class="line">&lt;h1&gt;学习资源大奉送，爱我就关注嘟嘟公众号：嘟爷java超神学堂（javaLearn）&lt;/h1&gt;</span><br><span class="line">&lt;table width=&quot;100%&quot; border=&quot;1&quot; cellspacing=&quot;1&quot; cellpadding=&quot;0&quot;&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;作者&lt;/td&gt;</span><br><span class="line">&lt;td&gt;教程名称&lt;/td&gt;</span><br><span class="line">&lt;td&gt;地址&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;!--/*@thymesVar id=&quot;learnList&quot; type=&quot;&quot;*/--&gt;</span><br><span class="line">&lt;tr th:each=&quot;learn : $&#123;learnList&#125;&quot;&gt;</span><br><span class="line">&lt;td th:text=&quot;$&#123;learn.author&#125;&quot;&gt;嘟嘟MD&lt;/td&gt;</span><br><span class="line">&lt;td th:text=&quot;$&#123;learn.title&#125;&quot;&gt;SPringBoot干货系列&lt;/td&gt;</span><br><span class="line">&lt;td&gt;&lt;a th:href=&quot;$&#123;learn.url&#125;&quot; target=&quot;_blank&quot;&gt;点我&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>


<blockquote>
<p>注：通过xmlns:th=”<a href="http://www.thymeleaf.org“" target="_blank" rel="noopener">http://www.thymeleaf.org“</a> 命令空间，将静态页面转换为动态的视图，需要进行动态处理的元素将使用“th:”前缀。</p>
</blockquote>
<h3 id="Thymeleaf的默认参数配置"><a href="#Thymeleaf的默认参数配置" class="headerlink" title="Thymeleaf的默认参数配置"></a>Thymeleaf的默认参数配置</h3><p>在application.properties中可以配置thymeleaf模板解析器属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># THYMELEAF (ThymeleafAutoConfiguration)</span><br><span class="line">#开启模板缓存（默认值：true）</span><br><span class="line">spring.thymeleaf.cache=true </span><br><span class="line">#Check that the template exists before rendering it.</span><br><span class="line">spring.thymeleaf.check-template=true </span><br><span class="line">#检查模板位置是否正确（默认值:true）</span><br><span class="line">spring.thymeleaf.check-template-location=true</span><br><span class="line">#Content-Type的值（默认值：text/html）</span><br><span class="line">spring.thymeleaf.content-type=text/html</span><br><span class="line">#开启MVC Thymeleaf视图解析（默认值：true）</span><br><span class="line">spring.thymeleaf.enabled=true</span><br><span class="line">#模板编码</span><br><span class="line">spring.thymeleaf.encoding=UTF-8</span><br><span class="line">#要被排除在解析之外的视图名称列表，用逗号分隔</span><br><span class="line">spring.thymeleaf.excluded-view-names=</span><br><span class="line">#要运用于模板之上的模板模式。另见StandardTemplate-ModeHandlers(默认值：HTML5)</span><br><span class="line">spring.thymeleaf.mode=HTML5</span><br><span class="line">#在构建URL时添加到视图名称前的前缀（默认值：classpath:/templates/）</span><br><span class="line">spring.thymeleaf.prefix=classpath:/templates/</span><br><span class="line">#在构建URL时添加到视图名称后的后缀（默认值：.html）</span><br><span class="line">spring.thymeleaf.suffix=.html</span><br><span class="line">#Thymeleaf模板解析器在解析器链中的顺序。默认情况下，它排第一位。顺序从1开始，只有在定义了额外的TemplateResolver Bean时才需要设置这个属性。</span><br><span class="line">spring.thymeleaf.template-resolver-order=</span><br><span class="line">#可解析的视图名称列表，用逗号分隔</span><br><span class="line">spring.thymeleaf.view-names=</span><br></pre></td></tr></table></figure>


<h3 id="整合一个bootstrap框架给大家"><a href="#整合一个bootstrap框架给大家" class="headerlink" title="整合一个bootstrap框架给大家"></a>整合一个bootstrap框架给大家</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC00LmpwZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>大家可以直接打开vanilla-cream-css下面的index.html来查看静态效果，如下：<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC01LmpwZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>动态效果的话可以查看template.html<br>这里把上面的资源例子重新用bootstrap写了下，效果不错哦，如下：</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC02LnBuZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>本章到此就结束了，下一篇准备介绍下如何整合jsp,毕竟现在绝大多数的企业还是用jsp来作为模板引擎的。</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-06T04:19:21.000Z" itemprop="datePublished">2019-11-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
        </div>
        <div class="column one-third">
          <!--处理未安装 search 插件 默认 Google 搜索-->
 

<h3>Search</h3>

<div id="site_search">

	<!-- Google -->
	

	<!-- 本地搜索 -->
	
		<form id="search-form" >
			<input type="text" id="search" placeholder="Search" >
			<button type="button" class="btn btn-default" id="site_search_do"><span class="octicon octicon-search"></span></button>
		</form>

		<div id="local-search-result"></div>

		<script src="/js/search.js"></script>	
		<script type="text/javascript">
			$(function(){
				var currentIndex = -1;
				var search_path = "search.xml";
				if (!search_path) search_path = "search.xml";
				var path = "/" + search_path;
				searchFunc(path, 'search', 'local-search-result');

				$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
					var liNode = $("#local-search-result>.search-result-list li");
					liNode.removeClass("hover");
					currentIndex = $("#local-search-result>.search-result-list li").index($(this));
					liNode.eq(currentIndex).addClass("hover");
				})

				$("#search-form").submit(function(){
					return false;
				})

				$("#search").keydown(function(event){
					var keyCode = event.keyCode;
					var liNode = $("#local-search-result>.search-result-list li");
					if(keyCode == 38 || keyCode == 40 || keyCode == 13){
						liNode.removeClass("hover");
						if(keyCode == 38){
							if(currentIndex - 1 >= 0) currentIndex --;
						}
						if(keyCode == 40){
							if(currentIndex + 1 < liNode.length) currentIndex ++;
						}
						if(keyCode == 13){
							location.href = liNode.eq(currentIndex).find("a").attr("href");
						}
						liNode.eq(currentIndex).addClass("hover");
						return false;
					}else{
						currentIndex = -1;
					}
				})
			})
		</script>

	

</div>

<h3>Popular Repositories</h3>
    <div class="popular-container"></div>
    
    <script type="text/template" id="popular-list-template">
        <a href="{%=clone_url%}" class="card text-center" target="_blank">
            <div class="thumbnail">
                <div class="card-image geopattern" data-pattern-id="{%=name%}">
                    <div class="card-image-cell">
                        <h3 class="card-title">
                            {%=name%}
                        </h3>
                    </div>
                </div>
                <div class="caption">
                    <div class="card-description">
                        <p class="card-text">
                            {%=description%}
                        </p>
                    </div>
                    <div class="card-text">
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=stargazers_count%} stars">
                            <span class="octicon octicon-star"></span> {%=stargazers_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=forks_count%} forks">
                            <span class="octicon octicon-git-branch"></span> {%=forks_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="最后更新时间：{%=updated_at%}">
                            <span class="octicon octicon-clock"></span>
                            <time datetime="{%=updated_at%}">{%=updated_at%}</time>
                        </span>
                    </div>
                </div>
            </div>
        </a>
    </script>

    <script src="/js/baiduTemplate.js"></script>
    <script type="text/javascript">
        var popular_repos = function(){

            var baiduTpl = new Object();

            var handleTpl = function(){
                baiduTpl.popular_list = baidu.template("popular-list-template");
            };

            var handleGithub = function(){
                var popularContainer = $(".popular-container");

                var repos = "vue-hr,vue-mobil,spring-boot-examples".split(",");
                for(var i in repos){
                    var name = repos[i];
                    $.get("https://api.github.com/repos/vanicesun/"+name,handle);
                }

                function handle(result){
                    result.updated_at = result.updated_at.split("T")[0];
                    if(result){
                        var html = baiduTpl.popular_list(result);
                        popularContainer.append(html);
                        $(".geopattern").each(function(){           
                            $(this).geopattern($(this).data('pattern-id'));
                        });
                    }
                }
            };

            return {
                init:function(){
                    handleTpl();
                    handleGithub();
                }
            }
        }; 
        $(popular_repos().init);
    </script>

        </div>
    </div>

    
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" target="_blank" rel="noopener" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" target="_blank" rel="noopener" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="首页">首页</a>
                  </li>
            
                  
                  <li>
                    <a href="/categories/"  title="分类">分类</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="开源">开源</a>
                  </li>
            
                  
                  <li>
                    <a href="/about/"  title="关于">关于</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	</body>
</html>