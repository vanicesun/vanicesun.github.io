<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />

  <link rel="icon" href="/favicon.ico">
  
  <title>萤火虫的博客</title>
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="/lib/fancybox/jquery.fancybox-1.3.4.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://cdn.staticfile.org/jquery/1.7/jquery.min.js" type="text/javascript" ></script>
</head>
<body class="home">
	<header class="site-header navfixed-false">
  <div class="container">
      <h1><a href="/" title="萤火虫的博客"><span class="octicon octicon-mark-github"></span> 萤火虫的博客</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/"  class=" site-header-nav-item hvr-underline-from-center" title="首页">首页</a>
        
              
              <a href="/categories/"  class=" site-header-nav-item hvr-underline-from-center" title="分类">分类</a>
        
              
              <a href="/open-source/"  class=" site-header-nav-item hvr-underline-from-center" title="开源">开源</a>
        
              
              <a href="/about/"  class=" site-header-nav-item hvr-underline-from-center" title="关于">关于</a>
        
      </nav>
  </div>
</header>

	<section class="banner-false">
    <div class="collection-head">
        <div class="container">
            <div class="collection-title">
                <h1 class="collection-header" id="site-description">
                    111
                </h1>
                <div class="collection-info">
                    
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-location">
                                   
                                        上海, 中国
                                    
                                </span>
                                
                            
                        </span>
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-mark-github">
                                   
                                </span>
                                
                                    <a href="http://github.com/vanicesun" target="_blank">vanicesun</a>
                                
                            
                        </span>
                    
                        <span class="meta-info">
                            
                                <span class="octicon octicon-organization">
                                   
                                        组织/公司
                                    
                                </span>
                                
                            
                        </span>
                    
                </div>
            </div>
        </div>
    </div>
</section>
	   <section class="container">
    <div class="columns">
        <div class="column two-thirds">
            
                  <article id="post-springboot-jpa" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/07/springboot-jpa/">SpringBoot开发案例之整合Spring-data-jpa</a>
  

      </h3>
      <div class="repo-list-description">
        
          <blockquote>
<p>即使你是天才，如果你不努力，你也会被其它人超越。</p>
</blockquote>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ibG9nLjUyaXRzdHlsZS52aXAvdXNyL3VwbG9hZHMvMjAxNy8wNy8xMjQ4NTc0MzguanBn?x-oss-process=image/format,png#pic_center" alt=""></p>
<h3 id="扯淡-我们是认真的"><a href="#扯淡-我们是认真的" class="headerlink" title="扯淡!我们是认真的"></a>扯淡!我们是认真的</h3><p>  扯了那么多篇SpringBoot的相关案例，基本每行代码都是博主纯手工编写，附代码案例，懂Maven和Git的小伙伴必须可以手到擒来。<br>SpringBoot使得开发变的更加简洁，快速，当然被封装的越来越深。此时你就要引入越来越多的第三方工具类，虽然你可以把搭建好的项目运行起来，却无法理解是怎么跑起来的。有些人带着疑惑查阅文档，阅读源码，多年以后便成了大牛；有些人不求甚解，能跑就行，就这样干了N年CURD。<br>俗话说的好，燕雀安知鸿鹄之志哉？然子非鱼又焉知鱼之乐？curd并快乐着。每个人，都会有自己的成长轨迹，或平凡或精彩或或或或，快使用双节棍，嘿嘿哈嘿。</p>
<h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>好了，淡就扯这么多，今天与大家分享一款”超薄”的数据访问层框架Spring-data-jpa，依赖Hibernate，对Hibernate有一定的基础，可以更好的理解。</p>
<h3 id="什么是spring-data"><a href="#什么是spring-data" class="headerlink" title="什么是spring-data"></a>什么是spring-data</h3><p>为了简化程序与数据库交互的代码，spring提供了一个现成的dao层框架，spring家族提供的spring-data适用于关系型数据库和nosql数据库。比如之前我们讲解的案例：<br>SpringBoot开发案例之整合mongoDB，当然还有Spring Data Solr，Spring Data Redis以及我们今天要分享的Spring Data JPA。</p>
<p>详解的可以参考:<img src="https://spring.io/projects/spring-data" alt="官网"></p>
<h3 id="什么是JPA"><a href="#什么是JPA" class="headerlink" title="什么是JPA"></a>什么是JPA</h3><p>JPA全称为Java持久性API（Java Persistence API），JPA是java EE 5标准之一，是一个ORM规范，由厂商来实现该规范，目前有hibernate、OpenJPA、TopLink、EclipseJPA等实现。</p>
<h3 id="如何使用JPA"><a href="#如何使用JPA" class="headerlink" title="如何使用JPA"></a>如何使用JPA</h3><p><strong>查询</strong></p>
<p>1.查询所有数据 findAll()<br>2.分页查询 findAll(new PageRequest(0, 2))<br>3.根据id查询 findOne()<br>4.根据实体类属性查询： findByProperty (type Property); 例如：findByAge(int age);<br>5.排序： findAll(sort )<br>6.Sort sort = new Sort(Sort.Direction.DESC, “age”).and (new Sort(Sort.Direction.DESC, “id”));<br>7.条件查询 and/or/findByAgeLessThan/LessThanEqual 等，<br>例如： findByUsernameAndPassword(String username , String password)<br>8.总数 查询 count() 或者 根据某个属性的值查询总数countByAge(int age);<br>9.是否存在某个id exists()<br>10.修改，删除，新增</p>
<p>1.新增：直接使用 save(T) 方法<br>2.删除： delete() 或者 deleteByProperty 例如：deleteByAge(int age) ;<br>3.更新：<br>@Modifying<br>@Query(“update Customer u set u.age = ?1 where u.id = ?2”)<br>int update(int age1 , long id);</p>
<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9ibG9nLjUyaXRzdHlsZS52aXAvdXNyL3VwbG9hZHMvMjAxNy8wNy8yOTI3ODM3NzY4LnBuZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<h3 id="相关配置"><a href="#相关配置" class="headerlink" title="相关配置"></a>相关配置</h3><p><strong>pom.xml(部分代码，详见源码)：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-data-jpa&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p><strong>application.properties：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"># 项目contextPath</span><br><span class="line">server.context-path=/jpa</span><br><span class="line"># 服务端口</span><br><span class="line">server.port=8080</span><br><span class="line"># session最大超时时间(分钟)，默认为30</span><br><span class="line">server.session-timeout=60</span><br><span class="line"># 该服务绑定IP地址，启动服务器时如本机不是该IP地址则抛出异常启动失败，只有特殊需求的情况下才配置</span><br><span class="line">#server.address=192.168.1.66</span><br><span class="line"> </span><br><span class="line"># tomcat最大线程数，默认为200</span><br><span class="line">server.tomcat.max-threads=100</span><br><span class="line"># tomcat的URI编码</span><br><span class="line">server.tomcat.uri-encoding=UTF-8</span><br><span class="line"> </span><br><span class="line">#注意中文乱码</span><br><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?characterEncoding=utf-8</span><br><span class="line">spring.datasource.username=root</span><br><span class="line">spring.datasource.password=123</span><br><span class="line">spring.datasource.driver-class-name=com.mysql.jdbc.Driver</span><br><span class="line"># Specify the DBMS</span><br><span class="line">spring.jpa.database = MYSQL</span><br><span class="line"># Show or not log for each sql query</span><br><span class="line">spring.jpa.show-sql = true</span><br><span class="line"># DDL mode. This is actually a shortcut for the &quot;hibernate.hbm2ddl.auto&quot; property. Default to &quot;create-drop&quot; when using an embedded database, &quot;none&quot; otherwise.</span><br><span class="line">spring.jpa.hibernate.ddl-auto = update</span><br><span class="line"># Hibernate 4 naming strategy fully qualified name. Not supported with Hibernate 5.</span><br><span class="line">spring.jpa.hibernate.naming.strategy = org.hibernate.cfg.ImprovedNamingStrategy</span><br><span class="line"># stripped before adding them to the entity manager)</span><br><span class="line">spring.jpa.properties.hibernate.dialect = org.hibernate.dialect.MySQL5Dialect</span><br></pre></td></tr></table></figure>
<p>spring.jpa.properties.hibernate.hbm2ddl.auto是hibernate的配置属性，其主要作用是：自动创建、更新、验证数据库表结构。该参数的几种配置如下：</p>
<p>1.create：每次加载hibernate时都会删除上一次的生成的表，然后根据你的model类再重新来生成新表，哪怕两次没有任何改变也要这样执行，这就是导致数据库表数据丢失的一个重要原因。<br>2.create-drop：每次加载hibernate时根据model类生成表，但是sessionFactory一关闭,表就自动删除。<br>3.update：最常用的属性，第一次加载hibernate时根据model类会自动建立起表的结构（前提是先建立好数据库），以后加载hibernate时根据model类自动更新表结构，即使表结构改变了但表中的行仍然存在不会删除以前的行。要注意的是当部署到服务器后，表结构是不会被马上建立起来的，是要等应用第一次运行起来后才会。<br>4.validate：每次加载hibernate时，验证创建数据库表结构，只会和数据库中的表进行比较，不会创建新表，但是会插入新值。<br>实体类 User.java:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">package com.itstyle.jpa.model;</span><br><span class="line">import java.io.Serializable;</span><br><span class="line">import javax.persistence.*;</span><br><span class="line">/**</span><br><span class="line"> * 用户实体(此处注意引用的注解包为javax.persistence*下面的)</span><br><span class="line"> * 创建者 科帮网</span><br><span class="line"> * 创建时间    2017年7月25日</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">@Entity</span><br><span class="line">@Table(name = &quot;sys_user&quot;)</span><br><span class="line">public class User implements Serializable&#123;</span><br><span class="line">    private static final long serialVersionUID = 1L;</span><br><span class="line">    @Id</span><br><span class="line">    @GeneratedValue(strategy = GenerationType.AUTO)</span><br><span class="line">    @Column(name = &quot;id&quot;, nullable = false)</span><br><span class="line">    private Long id;</span><br><span class="line">    @Column(nullable = false, name = &quot;name&quot;)</span><br><span class="line">    private String name;</span><br><span class="line">    @Column(nullable = false, name = &quot;age&quot;)</span><br><span class="line">    private Integer age;</span><br><span class="line">    --- 省略 get set 方法</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>数据操作UserRepository.java:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * 数据操作层</span><br><span class="line"> * 创建者 科帮网</span><br><span class="line"> * 创建时间    2017年7月25日</span><br><span class="line"> *</span><br><span class="line"> */</span><br><span class="line">public interface UserRepository extends JpaRepository&lt;User, Long&gt; &#123;</span><br><span class="line"></span><br><span class="line">    User findByName(String name);</span><br><span class="line">    </span><br><span class="line">    User findByAge(Integer age);</span><br><span class="line"></span><br><span class="line">    User findByNameAndAge(String name, Integer age);</span><br><span class="line">    </span><br><span class="line">    List&lt;User&gt; findByNameLike(String name);</span><br><span class="line"></span><br><span class="line">    @Query(&quot;from User u where u.name=:name&quot;)</span><br><span class="line">    User findUser(@Param(&quot;name&quot;) String name);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>小伙伴没有没有发现，我们只是定义了一个方法而已，怎么就这么奇妙的实现的对应功能？其实这是Spring-data-jpa的新特性，通过解析方法名创建查询。更多解析说明如下：</p>
<p>And =&gt; 等价于 SQL 中的 and 关键字 例如：findByUsernameAndPassword(String user, Striang pwd)；<br>Or =&gt; 等价于 SQL 中的 or 关键字，例如：findByUsernameOrAddress(String user, String addr)；<br>Between =&gt; 等价于 SQL 中的 between 关键字，例如：SalaryBetween(int max, int min)；<br>LessThan =&gt; 等价于 SQL 中的 “&lt;”，例如： findBySalaryLessThan(int max)；<br>GreaterThan =&gt; 等价于 SQL 中的”&gt;”，例如： findBySalaryGreaterThan(int min)；<br>IsNull =&gt; 等价于 SQL 中的 “is null”，例如： findByUsernameIsNull()；<br>IsNotNull =&gt; 等价于 SQL 中的 “is not null”，例如： findByUsernameIsNotNull()；<br>NotNull=&gt; 与 IsNotNull 等价；<br>Like =&gt; 等价于 SQL 中的 “like”，例如： findByUsernameLike(String user)；<br>NotLike =&gt; 等价于 SQL 中的 “not like”，例如： findByUsernameNotLike(String user)；<br>OrderBy =&gt; 等价于 SQL 中的 “order by”，例如： findByUsernameOrderBySalaryAsc(String user)；<br>Not =&gt; 等价于 SQL 中的 “！ =”，例如： findByUsernameNot(String user)；<br>In =&gt; 等价于 SQL 中的 “in”，例如： findByUsernameIn(Collection<String> userList) ，方法的参数可以是 Collection 类型，也可以是数组或者不定长参数；<br>NotIn =&gt; 等价于 SQL 中的 “not in”，例如： findByUsernameNotIn(Collection<String> userList) ，方法的参数可以是 Collection 类型，也可以是数组或者不定长参数；<br>创建一个按单字段排序的Sort对象: new Sort(Sort.Direction.DESC, “description”).and(new Sort(Sort.Direction.ASC, “id”))</p>
<p>最终测试类SpringbootJpaApplication.java:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">package com.itstyle.jpa;</span><br><span class="line"></span><br><span class="line">import java.util.List;</span><br><span class="line"></span><br><span class="line">import org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line">import org.springframework.boot.CommandLineRunner;</span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line"></span><br><span class="line">import com.itstyle.jpa.model.User;</span><br><span class="line">import com.itstyle.jpa.repository.UserRepository;</span><br><span class="line"></span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class SpringbootJpaApplication implements CommandLineRunner &#123;</span><br><span class="line"></span><br><span class="line">    @Autowired</span><br><span class="line">    private UserRepository userRepository;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        SpringApplication.run(SpringbootJpaApplication.class, args);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void run(String... args) throws Exception &#123;</span><br><span class="line">        try &#123;</span><br><span class="line">            User user = new User();</span><br><span class="line">            user.setName(&quot;张三&quot;);</span><br><span class="line">            user.setAge(20);</span><br><span class="line">            userRepository.save(user);</span><br><span class="line">            List&lt;User&gt; u = userRepository.findByNameLike(&quot;%张三%&quot;);</span><br><span class="line">            System.out.println(u.size());</span><br><span class="line">            User  us =  userRepository.findByAge(20);</span><br><span class="line">            System.out.println(us.getAge());</span><br><span class="line">            us =  userRepository.findByName(&quot;这是你干&quot;);</span><br><span class="line">        &#125; catch (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="偶遇问题"><a href="#偶遇问题" class="headerlink" title="偶遇问题"></a>偶遇问题</h3><p>No identifier specified for entity:</p>
<p>检查一下包是否引入正确，引入一下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import javax.persistence.*;</span><br></pre></td></tr></table></figure>
<p>中文乱码问题：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?characterEncoding=utf-8</span><br></pre></td></tr></table></figure>
<p>在高版本mysql中需要指定是否进行SSL连接</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.datasource.url=jdbc:mysql://localhost:3306/test?characterEncoding=utf-8&amp;useSSL=false</span><br></pre></td></tr></table></figure>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-07T07:28:42.000Z" itemprop="datePublished">2019-11-07</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-springboot" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/06/springboot/">Spring Boot开发常用的热部署方式汇总</a>
  

      </h3>
      <div class="repo-list-description">
        
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>平时开发Sprig Boot的时候，经常改动个小小的地方就要重新启动项目，这无疑是一种很差的体验。在此，博主收集了3种热部署的方案供大家选择。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>目前博主用过的有三种：</p>
<ul>
<li>Spring Loaded</li>
<li>spring-boot-devtools</li>
<li>JRebel插件</li>
</ul>
<h3 id="博主开发环境"><a href="#博主开发环境" class="headerlink" title="博主开发环境"></a>博主开发环境</h3><ul>
<li>系统：win10</li>
<li>开发工具：IDE:IntelliJ IDEA 2018.2</li>
<li>spring-boot版本：1.5.3RELEASE</li>
<li>JDK：1.8</li>
</ul>
<h3 id="Spring-Loaded-实现热部署"><a href="#Spring-Loaded-实现热部署" class="headerlink" title="Spring Loaded 实现热部署"></a>Spring Loaded 实现热部署</h3><p>Spring Loaded是一个用于在JVM运行时重新加载类文件更改的JVM代理,Spring Loaded允许你动态的新增/修改/删除某个方法/字段/构造方法,同样可以修改作用在类/方法/字段/构造方法上的注解.也可以新增/删除/改变枚举中的值。</p>
<p>spring-loaded是一个开源项目,项目地址:<a href="https://github.com/spring-projects/spring-loaded" target="_blank" rel="noopener">https://github.com/spring-projects/spring-loaded</a></p>
<p>Spring Loaded有两种方式实现，分别是Maven引入依赖方式或者添加启动参数方式</p>
<p>Maven依赖方式</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;plugin&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">&lt;dependencies&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;springloaded&lt;/artifactId&gt;</span><br><span class="line">&lt;version&gt;1.2.6.RELEASE&lt;/version&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br><span class="line">&lt;/plugin&gt;</span><br></pre></td></tr></table></figure>
<p><strong>启动：mvn spring-boot:run</strong><br>如果你也是IDEA的话，直接界面上双击运行即可，如下图<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjU1MC5wbmc?x-oss-process=image/format,png#pic_center" alt=""><br>注意：maven依赖的方式只适合spring-boot:run的启动方式，右键那种方式不行。</p>
<p>出现如下配置表实配置成功：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[INFO] Attaching agents: [C:\Users\tengj\.m2\repository\org\springframework\springloaded\1.2.6.RELEASE\springloaded-1.2.6.RELEASE.jar]</span><br></pre></td></tr></table></figure>

<h3 id="添加启动参数方式"><a href="#添加启动参数方式" class="headerlink" title="添加启动参数方式"></a>添加启动参数方式</h3><p>这种方式是右键运行启动类<br>首先先下载对应的springloaded-1.2.6.RELEASE.jar，可以去上面提到的官网获取<br>博主这里直接引用maven依赖已经下载好的路径哈</p>
<p>然后打开下图所示的Edit Configurations配置，在VM options中输入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-javaagent:C:\Users\tengj\.m2\repository\org\springframework\springloaded\1.2.6.RELEASE\springloaded-1.2.6.RELEASE.jar -noverify</span><br></pre></td></tr></table></figure>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjYxNS5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>然后直接右键运行启动类即可启动项目。</p>
<p>上面2种方式小伙伴随便选择一种即可,当系统通过 mvn spring-boot:run启动或者 右键application debug启动Java文件时，系统会监视classes文件，当有classes文件被改动时，系统会重新加载类文件，不用重启启动服务。</p>
<blockquote>
<p>注：IDEA下需要重新编译文件 Ctrl+Shift+F9或者编译项目 Ctrl+F9</p>
</blockquote>
<p>如何测试热部署是否可用呢，你可以先写个简单的Controller方法，返回个字符串，然后启动项目，接着修改下这个方法返回的字符串，Ctrl+Shift+F9编译下当前类，然后再刷新下页面看看是否内容改变了。</p>
<p>在 Spring Boot，模板引擎的页面默认是开启缓存，如果修改页面内容，刷新页面是无法获取修改后的页面内容，所以，如果我们不需要模板引擎的缓存，可以进行关闭。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">spring.freemarker.cache=false</span><br><span class="line">spring.thymeleaf.cache=false</span><br><span class="line">spring.velocity.cache=false</span><br></pre></td></tr></table></figure>

<p>经过博主简单的测试，发现大多数情况可以使用热部署，有效的解决了文章头部中提到的那个痛点，不过还是有一些情况下需要重新启动，不可用的情况如下：<br>1：对于一些第三方框架的注解的修改，不能自动加载，比如：spring mvc的@RequestMapping<br>2：application.properties的修改也不行<br>3：log4j的配置文件的修改不能即时生效</p>
<h3 id="Spring-boot-devtools-实现热部署"><a href="#Spring-boot-devtools-实现热部署" class="headerlink" title="Spring-boot-devtools 实现热部署"></a>Spring-boot-devtools 实现热部署</h3><p>spring-boot-devtools为应用提供一些开发时特性，包括默认值设置，自动重启，livereload等。</p>
<p>想要使用devtools热部署功能，maven添加依赖如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencies&gt;</span><br><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</span><br><span class="line">&lt;optional&gt;true&lt;/optional&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br><span class="line">&lt;/dependencies&gt;</span><br></pre></td></tr></table></figure>

<p>将依赖关系标记为可选<optional>true</optional>是一种最佳做法，可以防止使用项目将devtools传递性地应用于其他模块。</p>
<h3 id="默认属性"><a href="#默认属性" class="headerlink" title="默认属性"></a>默认属性</h3><p>在Spring Boot集成Thymeleaf时，spring.thymeleaf.cache属性设置为false可以禁用模板引擎编译的缓存结果。</p>
<p>现在，devtools会自动帮你做到这些，禁用所有模板的缓存，包括Thymeleaf, Freemarker, Groovy Templates, Velocity, Mustache等。</p>
<p>更多的属性，请参考DevToolsPropertyDefaultsPostProcessor。</p>
<h3 id="自动重启"><a href="#自动重启" class="headerlink" title="自动重启"></a>自动重启</h3><p>自动重启的原理在于spring boot使用两个classloader：不改变的类（如第三方jar）由base类加载器加载，正在开发的类由restart类加载器加载。应用重启时，restart类加载器被扔掉重建，而base类加载器不变，这种方法意味着应用程序重新启动通常比“冷启动”快得多，因为base类加载器已经可用并已填充。</p>
<p>所以，当我们开启devtools后，classpath中的文件变化会导致应用自动重启。<br>当然不同的IDE效果不一样，Eclipse中保存文件即可引起classpath更新(注：需要打开自动编译)，从而触发重启。而IDEA则需要自己手动CTRL+F9重新编译一下（感觉IDEA这种更好，不然每修改一个地方就重启，好蛋疼）</p>
<p>排除静态资源文件</p>
<p>静态资源文件在改变之后有时候没必要触发应用程序重启，例如thymeleaf模板文件就可以实时编辑，默认情况下，更改/META-INF/maven, /META-INF/resources ,/resources ,/static ,/public 或/templates下的资源不会触发重启，而是触发live reload（devtools内嵌了一个LiveReload server，当资源发生改变时，浏览器刷新,下面会介绍）。</p>
<p>可以使用spring.devtools.restart.exclude属性配置，例如</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.devtools.restart.exclude=static/**,public/**</span><br></pre></td></tr></table></figure>
<p>如果想保留默认配置，同时增加新的配置，则可使用</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">spring.devtools.restart.additional-exclude属性</span><br></pre></td></tr></table></figure>

<p>观察额外的路径</p>
<p>如果你想观察不在classpath中的路径的文件变化并触发重启，则可以配置 spring.devtools.restart.additional-paths 属性。</p>
<p>不在classpath内的path可以配置spring.devtools.restart.additionalpaths属性来增加到监视中，同时配置spring.devtools.restart.exclude可以选择这些path的变化是导致restart还是live reload。</p>
<p>关闭自动重启</p>
<p>设置 spring.devtools.restart.enabled 属性为false，可以关闭该特性。可以在application.properties中设置，也可以通过设置环境变量的方式。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">public static void main(String[] args) &#123;</span><br><span class="line">System.setProperty(&quot;spring.devtools.restart.enabled&quot;, &quot;false&quot;);</span><br><span class="line">SpringApplication.run(MyApp.class, args);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>使用一个触发文件</p>
<p>若不想每次修改都触发自动重启，可以设置spring.devtools.restart.trigger-file指向某个文件，只有更改这个文件时才触发自动重启。</p>
<p>自定义自动重启类加载器</p>
<p>默认时，IDE中打开的项目都会由restart加载器加载，jar文件由Base加载器加载，但是若你使用multi-module的项目，并且不是所有模块都被导入到IDE中，此时会导致加载器不一致。这时你可以创建META-INF/spring-devtools.properties文件，并增加restart.exclude.XXX，restart.include.XXX来配置哪些jar被restart加载，哪些被base加载。如：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">restart.include.companycommonlibs=/mycorp-common-[\\w-]+\.jar</span><br><span class="line">restart.include.projectcommon=/mycorp-myproj-[\\w-]+\.jar</span><br></pre></td></tr></table></figure>

<h3 id="LiveReload"><a href="#LiveReload" class="headerlink" title="LiveReload"></a>LiveReload</h3><p>DevTools内置了一个LiveReload服务,可以在资源变化时用来触发浏览器刷新。当然这个需要你浏览器安装了LiveReload插件，并且启动这个插件才行。很有意思，这里介绍下如何弄。</p>
<p>先去谷歌商店安装LiveReload插件，自己准备梯子。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjYzNS5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>安装好在要自动刷新的页面点击下图中图标，启动应用后更新页面内容或者css等都会触发页面自动刷新了。如下图，圈中的就是，点一下会变黑就是启动了。</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL3VwbG9hZC1pbWFnZXMuamlhbnNodS5pby91cGxvYWRfaW1hZ2VzLzU4MTE4ODEtZTVkZjJlOTczYTJlOGIyYS5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>最后展示效果，修改完html页面后，Ctrl+Shift+F9,没有重启，页面也会自动刷新了，太有趣了。<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjY1Ny5naWY#pic_center" alt=""></p>
<p>如果您不想在应用程序运行时启动LiveReload服务器，则可以将spring.devtools.livereload.enabled属性设置为false。</p>
<p>一次只能运行一个LiveReload服务器。开始应用程序之前，请确保没有其他LiveReload服务器正在运行。<br>如果你的IDE启动多个应用程序，则只有第一个应用程序将支持LiveReload。</p>
<h3 id="JRebel插件方式"><a href="#JRebel插件方式" class="headerlink" title="JRebel插件方式"></a>JRebel插件方式</h3><p>在IDEA中打开插件管理界面，按照下面的提示先安装上<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjcwNi5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>安装完插件后，需要去获取正版的激活码，这个可以直接去官网<a href="https://my.jrebel.com获取(需自备梯子)" target="_blank" rel="noopener">https://my.jrebel.com获取(需自备梯子)</a></p>
<p>1：通过fackbook登录，没有就去注册一个</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjcyMi5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>2：填写一些资料后(资料必须填写完整,否则JRebel激活不了)，复制激活码即可</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjczMS5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>3：重启IDEA后，在IDEA的Settings中找到JRebel输入复制的激活码即可<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC8yMDE5LTA4LTE4LTAyMjc0Mi5wbmc?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>出现绿色，即表示激活成功了。</p>
<p>4： 接着就如下所示，勾中JRebel方式后启动即可，即可享受JRebel带来的超爽体验</p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>以上就是平时Spring Boot开发种使用的热部署方式，小伙伴可以自己试试喜欢哪种就用哪种。<br>后面2种可能需要梯子，程序员应该都自备梯子翻墙了吧，如果没有可以找博主，博主和朋友合租了一台服务器安装代理，有需要的可以找我提供服务~ 稳定速度快，youtube上1080视频很流畅。你可以私信或者微信公众号后台留言皆可。</p>
<p>一直觉得自己写的不是技术，而是情怀，一篇篇文章是自己这一路走来的痕迹。靠专业技能的成功是最具可复制性的，希望我的这条路能让你少走弯路，希望我能帮你抹去知识的蒙尘，希望我能帮你理清知识的脉络，希望未来技术之巅上有你也有我。</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-06T07:14:39.000Z" itemprop="datePublished">2019-11-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-redis" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/06/redis/">Redis单机版和集群搭建部署</a>
  

      </h3>
      <div class="repo-list-description">
        
          <h3 id="Redis介绍"><a href="#Redis介绍" class="headerlink" title="Redis介绍"></a>Redis介绍</h3><p>Redis是用C语言开发的一个开源的高性能键值对（key-value）数据库。它通过提供多种键值数据类型来适应不同场景下的存储需求，目前为止Redis支持的键值数据类型如下：<br>1.字符串类型<br>2.散列类型<br>3.列表类型<br>4.集合类型<br>5.有序集合类型</p>
<h3 id="Redis的应用场景"><a href="#Redis的应用场景" class="headerlink" title="Redis的应用场景"></a>Redis的应用场景</h3><p>1.缓存（数据查询、短连接、新闻内容、商品内容等等）。（最多使用）<br>2.分布式集群架构中的session分离。<br>3.聊天室的在线好友列表。<br>4.任务队列。（秒杀、抢购、12306等等）<br>5.应用排行榜。<br>6.网站访问统计。<br>7.数据过期处理（可以精确到毫秒）</p>
<h3 id="Redis的安装"><a href="#Redis的安装" class="headerlink" title="Redis的安装"></a>Redis的安装</h3><p>edis是C语言开发，建议在linux上运行，本教程使用Centos6.4作为安装环境。<br>安装redis需要先将官网下载的源码进行编译，编译依赖gcc环境，如果没有gcc环境，需要安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc：yum install gcc-c++</span><br></pre></td></tr></table></figure>
<p>版本说明:<br><strong>本教程使用redis3.0版本。3.0版本主要增加了redis集群功能</strong>。<br>源码下载:<br>从官网下载<br>(<a href="http://download.redis.io/releases/redis-3.0.0.tar.gz" target="_blank" rel="noopener">http://download.redis.io/releases/redis-3.0.0.tar.gz</a>)<br>将redis-3.0.0.tar.gz拷贝到/usr/local下并解压</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tar -zxvf redis-3.0.0.tar.gz</span><br></pre></td></tr></table></figure>
<p><strong>进入解压后的目录进行编译</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/redis-3.0.0</span><br><span class="line">make</span><br></pre></td></tr></table></figure>
<p><strong>安装到指定目录,如 /usr/local/redis:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/redis-3.0.0 </span><br><span class="line">make PREFIX=/usr/local/redis install</span><br></pre></td></tr></table></figure>
<p>修改redis.conf配置文件：<br>redis.conf是redis的配置文件，redis.conf在redis源码目录。注意修改port作为redis进程的端口,port默认6379。<br>拷贝配置文件到安装目录下：进入源码目录，里面有一份配置文件 redis.conf，然后将其拷贝到安装路径下</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/redis</span><br><span class="line">mkdir conf</span><br><span class="line">cp /usr/local/redis-3.0.0/redis.conf  /usr/local/redis/bin</span><br></pre></td></tr></table></figure>
<p><strong>安装目录bin下的文件列表如下</strong><br><img src="https://img-blog.csdnimg.cn/20190715215104767.png#pic_center" alt=""></p>
<p><strong>redis3.0新增的redis-sentinel是redis集群管理工具可实现高可用</strong><br><img src="https://img-blog.csdnimg.cn/20190715215303200.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""></p>
<h3 id="Redis的启动方式"><a href="#Redis的启动方式" class="headerlink" title="Redis的启动方式"></a>Redis的启动方式</h3><p><strong>前端模式启动：</strong><br>直接运行bin/redis-server将以前端模式启动，前端模式启动的缺点是ssh命令窗口关闭则redis-server程序结束，不推荐使用此方法。如下图：<br><img src="https://img-blog.csdnimg.cn/20190715215424828.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""></p>
<p><strong>后端模式启动：</strong><br>修改redis.conf配置文件， <strong>daemonize yes</strong> 以后端模式启动。</p>
<p>执行如下命令启动redis：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd /usr/local/redis</span><br><span class="line">./bin/redis-server ./redis.conf</span><br></pre></td></tr></table></figure>
<p>redis默认使用6379端口。<br>也可更改redis.conf文件，修改端口号：</p>
<h3 id="通过jedis连接redis单机："><a href="#通过jedis连接redis单机：" class="headerlink" title="通过jedis连接redis单机："></a>通过jedis连接redis单机：</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line"> </span><br><span class="line">     &lt;groupId&gt;redis.clients&lt;/groupId&gt;</span><br><span class="line"> </span><br><span class="line">     &lt;artifactId&gt;jedis&lt;/artifactId&gt;</span><br><span class="line"> </span><br><span class="line">     &lt;version&gt;2.7.0&lt;/version&gt;</span><br><span class="line"> </span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>

<h3 id="单实例连接："><a href="#单实例连接：" class="headerlink" title="单实例连接："></a>单实例连接：</h3><p>通过创建单实例jedis对象连接redis服务，如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">// 单实例连接redis</span><br><span class="line">	@Test</span><br><span class="line">	public void testJedisSingle() &#123;</span><br><span class="line"> </span><br><span class="line">		Jedis jedis = new Jedis(&quot;192.168.101.3&quot;, 6379);</span><br><span class="line">		jedis.set(&quot;name&quot;, &quot;bar&quot;);</span><br><span class="line">		String name = jedis.get(&quot;name&quot;);</span><br><span class="line">		System.out.println(name);</span><br><span class="line">		jedis.close();</span><br><span class="line"> </span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="外部连接不上redis的解决方法："><a href="#外部连接不上redis的解决方法：" class="headerlink" title="外部连接不上redis的解决方法："></a>外部连接不上redis的解决方法：</h3><p>由于linux防火墙默认开启，redis的服务端口6379并不在开放规则之内，所有需要将此端口开放访问或者关闭防火墙。</p>
<p><strong>关闭防火墙命令：sevice iptables stop</strong></p>
<p><strong>如果是修改防火墙规则，可以修改：/etc/sysconfig/iptables文件</strong></p>
<h3 id="使用连接池连接："><a href="#使用连接池连接：" class="headerlink" title="使用连接池连接："></a>使用连接池连接：</h3><p>通过单实例连接redis不能对redis连接进行共享，可以使用连接池对redis连接进行共享，提高资源利用率，使用jedisPool连接redis服务，如下代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">@Test</span><br><span class="line">	public void pool() &#123;</span><br><span class="line">		JedisPoolConfig config = new JedisPoolConfig();</span><br><span class="line">		//最大连接数</span><br><span class="line">		config.setMaxTotal(30);</span><br><span class="line">		//最大连接空闲数</span><br><span class="line">		config.setMaxIdle(2);</span><br><span class="line">		</span><br><span class="line">		JedisPool pool = new JedisPool(config, &quot;192.168.101.3&quot;, 6379);</span><br><span class="line">		Jedis jedis = null;</span><br><span class="line"> </span><br><span class="line">		try  &#123;</span><br><span class="line">			jedis = pool.getResource();</span><br><span class="line">			</span><br><span class="line">			jedis.set(&quot;name&quot;, &quot;lisi&quot;);</span><br><span class="line">			String name = jedis.get(&quot;name&quot;);</span><br><span class="line">			System.out.println(name);</span><br><span class="line">		&#125;catch(Exception ex)&#123;</span><br><span class="line">			ex.printStackTrace();</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			if(jedis != null)&#123;</span><br><span class="line">				//关闭连接</span><br><span class="line">				jedis.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="jedis与spring整合："><a href="#jedis与spring整合：" class="headerlink" title="jedis与spring整合："></a>jedis与spring整合：</h3><p>配置spring配置文件applicationContext.xml</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;beans xmlns=&quot;http://www.springframework.org/schema/beans&quot;</span><br><span class="line">	xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xmlns:mvc=&quot;http://www.springframework.org/schema/mvc&quot;</span><br><span class="line">	xmlns:context=&quot;http://www.springframework.org/schema/context&quot;</span><br><span class="line">	xmlns:aop=&quot;http://www.springframework.org/schema/aop&quot; xmlns:tx=&quot;http://www.springframework.org/schema/tx&quot;</span><br><span class="line">	xsi:schemaLocation=&quot;http://www.springframework.org/schema/beans </span><br><span class="line">		http://www.springframework.org/schema/beans/spring-beans-3.2.xsd </span><br><span class="line">		http://www.springframework.org/schema/mvc </span><br><span class="line">		http://www.springframework.org/schema/mvc/spring-mvc-3.2.xsd </span><br><span class="line">		http://www.springframework.org/schema/context </span><br><span class="line">		http://www.springframework.org/schema/context/spring-context-3.2.xsd </span><br><span class="line">		http://www.springframework.org/schema/aop </span><br><span class="line">		http://www.springframework.org/schema/aop/spring-aop-3.2.xsd </span><br><span class="line">		http://www.springframework.org/schema/tx </span><br><span class="line">		http://www.springframework.org/schema/tx/spring-tx-3.2.xsd &quot;&gt;</span><br><span class="line"> </span><br><span class="line">&lt;!-- 连接池配置 --&gt;</span><br><span class="line">	&lt;bean id=&quot;jedisPoolConfig&quot; class=&quot;redis.clients.jedis.JedisPoolConfig&quot;&gt;</span><br><span class="line">		&lt;!-- 最大连接数 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxTotal&quot; value=&quot;30&quot; /&gt;</span><br><span class="line">		&lt;!-- 最大空闲连接数 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxIdle&quot; value=&quot;10&quot; /&gt;</span><br><span class="line">		&lt;!-- 每次释放连接的最大数目 --&gt;</span><br><span class="line">		&lt;property name=&quot;numTestsPerEvictionRun&quot; value=&quot;1024&quot; /&gt;</span><br><span class="line">		&lt;!-- 释放连接的扫描间隔（毫秒） --&gt;</span><br><span class="line">		&lt;property name=&quot;timeBetweenEvictionRunsMillis&quot; value=&quot;30000&quot; /&gt;</span><br><span class="line">		&lt;!-- 连接最小空闲时间 --&gt;</span><br><span class="line">		&lt;property name=&quot;minEvictableIdleTimeMillis&quot; value=&quot;1800000&quot; /&gt;</span><br><span class="line">		&lt;!-- 连接空闲多久后释放, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲连接数 时直接释放 --&gt;</span><br><span class="line">		&lt;property name=&quot;softMinEvictableIdleTimeMillis&quot; value=&quot;10000&quot; /&gt;</span><br><span class="line">		&lt;!-- 获取连接时的最大等待毫秒数,小于零:阻塞不确定的时间,默认-1 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxWaitMillis&quot; value=&quot;1500&quot; /&gt;</span><br><span class="line">		&lt;!-- 在获取连接的时候检查有效性, 默认false --&gt;</span><br><span class="line">		&lt;property name=&quot;testOnBorrow&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;!-- 在空闲时检查有效性, 默认false --&gt;</span><br><span class="line">		&lt;property name=&quot;testWhileIdle&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;!-- 连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true --&gt;</span><br><span class="line">		&lt;property name=&quot;blockWhenExhausted&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br><span class="line">	</span><br><span class="line">	&lt;!-- redis单机 通过连接池 --&gt;</span><br><span class="line">	&lt;bean id=&quot;jedisPool&quot; class=&quot;redis.clients.jedis.JedisPool&quot; destroy-method=&quot;close&quot;&gt;</span><br><span class="line">		&lt;constructor-arg name=&quot;poolConfig&quot; ref=&quot;jedisPoolConfig&quot;/&gt;</span><br><span class="line">		&lt;constructor-arg name=&quot;host&quot; value=&quot;192.168.25.145&quot;/&gt;</span><br><span class="line">		&lt;constructor-arg name=&quot;port&quot; value=&quot;6379&quot;/&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p>测试代码：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">private ApplicationContext applicationContext;</span><br><span class="line"> </span><br><span class="line">	@Before</span><br><span class="line">	public void init() &#123;</span><br><span class="line">		applicationContext = new ClassPathXmlApplicationContext(</span><br><span class="line">				&quot;classpath:applicationContext.xml&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	@Test</span><br><span class="line">	public void testJedisPool() &#123;</span><br><span class="line">	JedisPool pool = (JedisPool) applicationContext.getBean(&quot;jedisPool&quot;);</span><br><span class="line">			try  &#123;</span><br><span class="line">			jedis = pool.getResource();</span><br><span class="line">			</span><br><span class="line">			jedis.set(&quot;name&quot;, &quot;lisi&quot;);</span><br><span class="line">			String name = jedis.get(&quot;name&quot;);</span><br><span class="line">			System.out.println(name);</span><br><span class="line">		&#125;catch(Exception ex)&#123;</span><br><span class="line">			ex.printStackTrace();</span><br><span class="line">		&#125;finally&#123;</span><br><span class="line">			if(jedis != null)&#123;</span><br><span class="line">				//关闭连接</span><br><span class="line">				jedis.close();</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Redis集群："><a href="#Redis集群：" class="headerlink" title="Redis集群："></a>Redis集群：</h3><p>1.集群原理redis-cluster架构图<br><img src="https://img-blog.csdnimg.cn/20190715220219576.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br><strong>架构细节:</strong><br>(1)所有的redis节点彼此互联(PING-PONG机制),内部使用二进制协议优化传输速度和带宽.</p>
<p>(2)节点的fail是通过集群中超过半数的节点检测失效时才生效.</p>
<p>(3)客户端与redis节点直连,不需要中间proxy层.客户端不需要连接集群所有节点,连接集群中任何一个可用节点即可</p>
<p>(4)redis-cluster把所有的物理节点映射到[0-16383]slot上,cluster 负责维护node&lt;-&gt;slot&lt;-&gt;value</p>
<p><strong>Redis 集群中内置了 16384 个哈希槽，当需要在 Redis 集群中放置一个 key-value 时，redis 先对 key 使用 crc16 算法算出一个结果，然后把结果对 16384 求余数，这样每个 key 都会对应一个编号在 0-16383 之间的哈希槽，redis 会根据节点数量大致均等的将哈希槽映射到不同的节点。</strong></p>
<h3 id="redis-cluster投票-容错"><a href="#redis-cluster投票-容错" class="headerlink" title="redis-cluster投票:容错"></a>redis-cluster投票:容错</h3><p><img src="https://img-blog.csdnimg.cn/20190715220320211.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""><br>(1)领着投票过程是集群中所有master参与,如果半数以上master节点与master节点通信超过(cluster-node-timeout),认为当前master节点挂掉.</p>
<p>(2):什么时候整个集群不可用(cluster_state:fail)? </p>
<pre><code>a:如果集群任意master挂掉,且当前master没有slave.集群进入fail状态,也可以理解成集群的slot映射[0-16383]不完成时进入fail状态. ps : redis-3.0.0.rc1加入cluster-require-full-coverage参数,默认关闭,打开集群兼容部分失败.

b:如果集群超过半数以上master挂掉，无论是否有slave集群进入fail状态.

ps:当集群不可用时,所有对集群的操作做都不可用，收到((error) CLUSTERDOWN The cluster is down)错误</code></pre><h3 id="Ruby环境："><a href="#Ruby环境：" class="headerlink" title="Ruby环境："></a>Ruby环境：</h3><p>redis集群管理工具redis-trib.rb依赖ruby环境，首先需要安装ruby环境：</p>
<p>安装ruby：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">yum install ruby</span><br><span class="line"></span><br><span class="line">yum install rubygems</span><br></pre></td></tr></table></figure>

<p>安装ruby和redis的接口程序：</p>
<p>拷贝redis-3.0.0.gem至/usr/local下</p>
<p>执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem install /usr/local/redis-3.0.0.gem</span><br></pre></td></tr></table></figure>

<h3 id="创建集群：集群结点规划："><a href="#创建集群：集群结点规划：" class="headerlink" title="创建集群：集群结点规划："></a>创建集群：集群结点规划：</h3><p>这里在同一台服务器用不同的端口表示不同的redis服务器，如下：</p>
<p>主节点：192.168.101.3:7001 192.168.101.3:7002 192.168.101.3:7003</p>
<p>从节点：192.168.101.3:7004 192.168.101.3:7005 192.168.101.3:7006</p>
<p>在/usr/local下创建redis-cluster目录，其下创建7001、7002。。7006目录，如下：<br><img src="https://img-blog.csdnimg.cn/20190715220536940.png#pic_center" alt=""><br>将redis安装目录bin下的文件拷贝到每个700X目录内，同时将redis源码目录src下的redis-trib.rb拷贝到redis-cluster目录下。</p>
<p>修改每个700X目录下的redis.conf配置文件：<br><strong>port XXXX</strong><br><strong>#bind 192.168.101.3</strong><br><strong>cluster-enabled yes</strong></p>
<h3 id="​​​​​​​启动每个结点redis服务："><a href="#​​​​​​​启动每个结点redis服务：" class="headerlink" title="​​​​​​​启动每个结点redis服务："></a>​​​​​​​启动每个结点redis服务：</h3><p>分别进入7001、7002、…7006目录，执行：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-server ./redis.conf</span><br></pre></td></tr></table></figure>
<p>查看redis进程：<br><img src="https://img-blog.csdnimg.cn/20190715220719248.png#pic_center" alt=""></p>
<h3 id="执行创建集群命令："><a href="#执行创建集群命令：" class="headerlink" title="执行创建集群命令："></a>执行创建集群命令：</h3><p>执行redis-trib.rb，此脚本是ruby脚本，它依赖ruby环境。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb create --replicas 1 192.168.131.102:7001 192.168.131.102:7002 192.168.131.102:7003 192.168.131.102:7004 192.168.131.102:7005  192.168.131.102:7006</span><br></pre></td></tr></table></figure>
<p>说明：</p>
<p>redis集群至少需要3个主节点，每个主节点有一个从节点总共6个节点</p>
<p>replicas指定为1表示每个主节点有一个从节点</p>
<p><strong>注意：</strong></p>
<p><strong>如果执行时报如下错误：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ERR] Node XXXXXX is not empty. Either the node already knows other nodes (check with CLUSTER NODES) or contains some key in database 0</span><br></pre></td></tr></table></figure>
<p>解决方法是删除生成的配置文件nodes.conf，如果不行则说明现在创建的结点包括了旧集群的结点信息，需要删除redis的持久化文件后再重启redis，比如：appendonly.aof、dump.rdb<br><strong>创建集群输出如下：</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&gt;&gt;&gt; Creating cluster</span><br><span class="line">Connecting to node 192.168.101.3:7001: OK</span><br><span class="line">Connecting to node 192.168.101.3:7002: OK</span><br><span class="line">Connecting to node 192.168.101.3:7003: OK</span><br><span class="line">Connecting to node 192.168.101.3:7004: OK</span><br><span class="line">Connecting to node 192.168.101.3:7005: OK</span><br><span class="line">Connecting to node 192.168.101.3:7006: OK</span><br><span class="line">&gt;&gt;&gt; Performing hash slots allocation on 6 nodes...</span><br><span class="line">Using 3 masters:</span><br><span class="line">192.168.101.3:7001</span><br><span class="line">192.168.101.3:7002</span><br><span class="line">192.168.101.3:7003</span><br><span class="line">Adding replica 192.168.101.3:7004 to 192.168.101.3:7001</span><br><span class="line">Adding replica 192.168.101.3:7005 to 192.168.101.3:7002</span><br><span class="line">Adding replica 192.168.101.3:7006 to 192.168.101.3:7003</span><br><span class="line">M: cad9f7413ec6842c971dbcc2c48b4ca959eb5db4 192.168.101.3:7001</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">M: 4e7c2b02f0c4f4cfe306d6ad13e0cfee90bf5841 192.168.101.3:7002</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">M: 1a8420896c3ff60b70c716e8480de8e50749ee65 192.168.101.3:7003</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">S: 69d94b4963fd94f315fba2b9f12fae1278184fe8 192.168.101.3:7004</span><br><span class="line">   replicates cad9f7413ec6842c971dbcc2c48b4ca959eb5db4</span><br><span class="line">S: d2421a820cc23e17a01b597866fd0f750b698ac5 192.168.101.3:7005</span><br><span class="line">   replicates 4e7c2b02f0c4f4cfe306d6ad13e0cfee90bf5841</span><br><span class="line">S: 444e7bedbdfa40714ee55cd3086b8f0d5511fe54 192.168.101.3:7006</span><br><span class="line">   replicates 1a8420896c3ff60b70c716e8480de8e50749ee65</span><br><span class="line">Can I set the above configuration? (type &apos;yes&apos; to accept): yes</span><br><span class="line">&gt;&gt;&gt; Nodes configuration updated</span><br><span class="line">&gt;&gt;&gt; Assign a different config epoch to each node</span><br><span class="line">&gt;&gt;&gt; Sending CLUSTER MEET messages to join the cluster</span><br><span class="line">Waiting for the cluster to join...</span><br><span class="line">&gt;&gt;&gt; Performing Cluster Check (using node 192.168.101.3:7001)</span><br><span class="line">M: cad9f7413ec6842c971dbcc2c48b4ca959eb5db4 192.168.101.3:7001</span><br><span class="line">   slots:0-5460 (5461 slots) master</span><br><span class="line">M: 4e7c2b02f0c4f4cfe306d6ad13e0cfee90bf5841 192.168.101.3:7002</span><br><span class="line">   slots:5461-10922 (5462 slots) master</span><br><span class="line">M: 1a8420896c3ff60b70c716e8480de8e50749ee65 192.168.101.3:7003</span><br><span class="line">   slots:10923-16383 (5461 slots) master</span><br><span class="line">M: 69d94b4963fd94f315fba2b9f12fae1278184fe8 192.168.101.3:7004</span><br><span class="line">   slots: (0 slots) master</span><br><span class="line">   replicates cad9f7413ec6842c971dbcc2c48b4ca959eb5db4</span><br><span class="line">M: d2421a820cc23e17a01b597866fd0f750b698ac5 192.168.101.3:7005</span><br><span class="line">   slots: (0 slots) master</span><br><span class="line">   replicates 4e7c2b02f0c4f4cfe306d6ad13e0cfee90bf5841</span><br><span class="line">M: 444e7bedbdfa40714ee55cd3086b8f0d5511fe54 192.168.101.3:7006</span><br><span class="line">   slots: (0 slots) master</span><br><span class="line">   replicates 1a8420896c3ff60b70c716e8480de8e50749ee65</span><br><span class="line">[OK] All nodes agree about slots configuration.</span><br><span class="line">&gt;&gt;&gt; Check for open slots...</span><br><span class="line">&gt;&gt;&gt; Check slots coverage...</span><br><span class="line">[OK] All 16384 slots covered.</span><br></pre></td></tr></table></figure>

<h3 id="查询集群信息："><a href="#查询集群信息：" class="headerlink" title="查询集群信息："></a>查询集群信息：</h3><p>集群创建成功登陆任意redis结点查询集群中的节点情况。</p>
<p>客户端以集群方式登陆：<br><img src="https://img-blog.csdnimg.cn/20190715221045864.png#pic_center" alt=""></p>
<p>说明：</p>
<p><strong>./redis-cli -c -h 192.168.101.3 -p 7001 ，其中-c表示以集群方式连接redis，-h指定ip地址，-p指定端口号</strong></p>
<p><strong>cluster nodes 查询集群结点信息</strong></p>
<p><strong>cluster info 查询集群状态信息</strong><br><img src="https://img-blog.csdnimg.cn/20190715221209825.png#pic_center" alt=""></p>
<h3 id="添加主节点："><a href="#添加主节点：" class="headerlink" title="添加主节点："></a>添加主节点：</h3><p>集群创建成功后可以向集群中添加节点，下面是添加一个master主节点</p>
<p>添加7007结点，参考集群结点规划章节添加一个“7007”目录作为新节点。</p>
<p>执行下边命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb add-node  192.168.101.3:7007 192.168.101.3:7001</span><br></pre></td></tr></table></figure>
<p><img src="https://img-blog.csdnimg.cn/2019071522141486.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""></p>
<p>查看集群结点发现7007已添加到集群中：<br><img src="https://img-blog.csdnimg.cn/20190715221458393.png#pic_center" alt=""></p>
<h3 id="​​​​​​​hash槽重新分配："><a href="#​​​​​​​hash槽重新分配：" class="headerlink" title="​​​​​​​hash槽重新分配："></a>​​​​​​​hash槽重新分配：</h3><p>添加完主节点需要对主节点进行hash槽分配这样该主节才可以存储数据。</p>
<p>redis集群有16384个槽，集群中的每个结点分配自已槽，通过查看集群结点可以看到槽占用情况。<br><img src="https://img-blog.csdnimg.cn/20190715221552681.png#pic_center" alt=""></p>
<p><strong>给刚添加的7007结点分配槽：</strong></p>
<p><strong>第一步：连接上集群</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb reshard 192.168.101.3:7001（连接集群中任意一个可用结点都行）</span><br></pre></td></tr></table></figure>

<p><strong>第二步：输入要分配的槽数量</strong><br><img src="https://img-blog.csdnimg.cn/20190715221728575.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""></p>
<p><strong>输入 500表示要分配500个槽</strong></p>
<p><strong>第三步：输入接收槽的结点id</strong><br><img src="https://img-blog.csdnimg.cn/20190715221828402.png#pic_center" alt=""></p>
<p>这里准备给7007分配槽，通过cluster nodes查看7007结点id为15b809eadae88955e36bcdbb8144f61bbbaf38fb</p>
<p><strong>输入：15b809eadae88955e36bcdbb8144f61bbbaf38fb</strong></p>
<p><strong>第四步：输入源结点id</strong><br><img src="https://img-blog.csdnimg.cn/20190715221925399.png#pic_center" alt=""></p>
<p><strong>这里输入all</strong></p>
<p><strong>第五步：输入yes开始移动槽到目标结点id</strong><br><img src="https://img-blog.csdnimg.cn/2019071522202281.png#pic_center" alt=""></p>
<h3 id="添加从节点"><a href="#添加从节点" class="headerlink" title="添加从节点"></a>添加从节点</h3><p>集群创建成功后可以向集群中添加节点，下面是添加一个slave从节点。</p>
<p>添加7008从结点，将7008作为7007的从结点。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb add-node --slave --master-id 主节点id 添加节点的ip和端口 集群中已存在节点ip和端口</span><br></pre></td></tr></table></figure>
<p>执行如下命令：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">./redis-trib.rb add-node --slave --master-id cad9f7413ec6842c971dbcc2c48b4ca959eb5db4  192.168.101.3:7008 192.168.101.3:7001</span><br></pre></td></tr></table></figure>
<p><strong>cad9f7413ec6842c971dbcc2c48b4ca959eb5db4  是7007结点的id，可通过cluster nodes查看。</strong></p>
<p><img src="https://img-blog.csdnimg.cn/201907152222443.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3dlaXhpbl80MjEwMDA2NA==,size_16,color_FFFFFF,t_70#pic_center" alt=""></p>
<p>注意：如果原来该结点在集群中的配置信息已经生成cluster-config-file指定的配置文件中（如果cluster-config-file没有指定则默认为nodes.conf），这时可能会报错：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ERR] Node XXXXXX is not empty. Either the node already knows other nodes (check with CLUSTER NODES) or contains some key in database 0</span><br></pre></td></tr></table></figure>
<p><strong>解决方法是删除生成的配置文件nodes.conf，删除后再执行./redis-trib.rb add-node指令</strong></p>
<p>查看集群中的结点，刚添加的7008为7007的从节点：</p>
<p><img src="https://img-blog.csdnimg.cn/20190715222335195.png#pic_center" alt=""></p>
<h3 id="删除结点"><a href="#删除结点" class="headerlink" title="删除结点"></a>删除结点</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/redis-trib.rb del-node 127.0.0.1:7005 4b45eb75c8b428fbd77ab979b85080146a9bc017</span><br></pre></td></tr></table></figure>
<p>删除已经占有hash槽的结点会失败，报错如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[ERR] Node 127.0.0.1:7005 is not empty! Reshard data away and try again.</span><br></pre></td></tr></table></figure>
<p>需要将该结点占用的hash槽分配出去（参考hash槽重新分配章节）。</p>
<h3 id="JedisCluster"><a href="#JedisCluster" class="headerlink" title="JedisCluster"></a>JedisCluster</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// 连接redis集群</span><br><span class="line">	@Test</span><br><span class="line">	public void testJedisCluster() &#123;</span><br><span class="line"> </span><br><span class="line">		JedisPoolConfig config = new JedisPoolConfig();</span><br><span class="line">		// 最大连接数</span><br><span class="line">		config.setMaxTotal(30);</span><br><span class="line">		// 最大连接空闲数</span><br><span class="line">		config.setMaxIdle(2);</span><br><span class="line"> </span><br><span class="line">		//集群结点</span><br><span class="line">		Set&lt;HostAndPort&gt; jedisClusterNode = new HashSet&lt;HostAndPort&gt;();</span><br><span class="line">		jedisClusterNode.add(new HostAndPort(&quot;192.168.101.3&quot;, 7001));</span><br><span class="line">		jedisClusterNode.add(new HostAndPort(&quot;192.168.101.3&quot;, 7002));</span><br><span class="line">		jedisClusterNode.add(new HostAndPort(&quot;192.168.101.3&quot;, 7003));</span><br><span class="line">		jedisClusterNode.add(new HostAndPort(&quot;192.168.101.3&quot;, 7004));</span><br><span class="line">		jedisClusterNode.add(new HostAndPort(&quot;192.168.101.3&quot;, 7005));</span><br><span class="line">		jedisClusterNode.add(new HostAndPort(&quot;192.168.101.3&quot;, 7006));</span><br><span class="line">		JedisCluster jc = new JedisCluster(jedisClusterNode, config);</span><br><span class="line">		</span><br><span class="line">		JedisCluster jcd = new JedisCluster(jedisClusterNode);</span><br><span class="line">		jcd.set(&quot;name&quot;, &quot;zhangsan&quot;);</span><br><span class="line">		String value = jcd.get(&quot;name&quot;);</span><br><span class="line">		System.out.println(value);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>

<h3 id="整合Spring框架-配置applicationContext-xml"><a href="#整合Spring框架-配置applicationContext-xml" class="headerlink" title="整合Spring框架 配置applicationContext.xml"></a>整合Spring框架 配置applicationContext.xml</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 连接池配置 --&gt;</span><br><span class="line">	&lt;bean id=&quot;jedisPoolConfig&quot; class=&quot;redis.clients.jedis.JedisPoolConfig&quot;&gt;</span><br><span class="line">		&lt;!-- 最大连接数 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxTotal&quot; value=&quot;30&quot; /&gt;</span><br><span class="line">		&lt;!-- 最大空闲连接数 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxIdle&quot; value=&quot;10&quot; /&gt;</span><br><span class="line">		&lt;!-- 每次释放连接的最大数目 --&gt;</span><br><span class="line">		&lt;property name=&quot;numTestsPerEvictionRun&quot; value=&quot;1024&quot; /&gt;</span><br><span class="line">		&lt;!-- 释放连接的扫描间隔（毫秒） --&gt;</span><br><span class="line">		&lt;property name=&quot;timeBetweenEvictionRunsMillis&quot; value=&quot;30000&quot; /&gt;</span><br><span class="line">		&lt;!-- 连接最小空闲时间 --&gt;</span><br><span class="line">		&lt;property name=&quot;minEvictableIdleTimeMillis&quot; value=&quot;1800000&quot; /&gt;</span><br><span class="line">		&lt;!-- 连接空闲多久后释放, 当空闲时间&gt;该值 且 空闲连接&gt;最大空闲连接数 时直接释放 --&gt;</span><br><span class="line">		&lt;property name=&quot;softMinEvictableIdleTimeMillis&quot; value=&quot;10000&quot; /&gt;</span><br><span class="line">		&lt;!-- 获取连接时的最大等待毫秒数,小于零:阻塞不确定的时间,默认-1 --&gt;</span><br><span class="line">		&lt;property name=&quot;maxWaitMillis&quot; value=&quot;1500&quot; /&gt;</span><br><span class="line">		&lt;!-- 在获取连接的时候检查有效性, 默认false --&gt;</span><br><span class="line">		&lt;property name=&quot;testOnBorrow&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;!-- 在空闲时检查有效性, 默认false --&gt;</span><br><span class="line">		&lt;property name=&quot;testWhileIdle&quot; value=&quot;true&quot; /&gt;</span><br><span class="line">		&lt;!-- 连接耗尽时是否阻塞, false报异常,ture阻塞直到超时, 默认true --&gt;</span><br><span class="line">		&lt;property name=&quot;blockWhenExhausted&quot; value=&quot;false&quot; /&gt;</span><br><span class="line">	&lt;/bean&gt;	</span><br><span class="line">	&lt;!-- redis集群 --&gt;</span><br><span class="line">	&lt;bean id=&quot;jedisCluster&quot; class=&quot;redis.clients.jedis.JedisCluster&quot;&gt;</span><br><span class="line">		&lt;constructor-arg index=&quot;0&quot;&gt;</span><br><span class="line">			&lt;set&gt;</span><br><span class="line">				&lt;bean class=&quot;redis.clients.jedis.HostAndPort&quot;&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;0&quot; value=&quot;192.168.101.3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;1&quot; value=&quot;7001&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">				&lt;bean class=&quot;redis.clients.jedis.HostAndPort&quot;&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;0&quot; value=&quot;192.168.101.3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;1&quot; value=&quot;7002&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">				&lt;bean class=&quot;redis.clients.jedis.HostAndPort&quot;&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;0&quot; value=&quot;192.168.101.3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;1&quot; value=&quot;7003&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">				&lt;bean class=&quot;redis.clients.jedis.HostAndPort&quot;&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;0&quot; value=&quot;192.168.101.3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;1&quot; value=&quot;7004&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">				&lt;bean class=&quot;redis.clients.jedis.HostAndPort&quot;&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;0&quot; value=&quot;192.168.101.3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;1&quot; value=&quot;7005&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">				&lt;bean class=&quot;redis.clients.jedis.HostAndPort&quot;&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;0&quot; value=&quot;192.168.101.3&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">					&lt;constructor-arg index=&quot;1&quot; value=&quot;7006&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">				&lt;/bean&gt;</span><br><span class="line">			&lt;/set&gt;</span><br><span class="line">		&lt;/constructor-arg&gt;</span><br><span class="line">		&lt;constructor-arg index=&quot;1&quot; ref=&quot;jedisPoolConfig&quot;&gt;&lt;/constructor-arg&gt;</span><br><span class="line">	&lt;/bean&gt;</span><br></pre></td></tr></table></figure>
<p><strong>测试代码:</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">private ApplicationContext applicationContext;</span><br><span class="line"> </span><br><span class="line">	@Before</span><br><span class="line">	public void init() &#123;</span><br><span class="line">		applicationContext = new ClassPathXmlApplicationContext(</span><br><span class="line">				&quot;classpath:applicationContext.xml&quot;);</span><br><span class="line">	&#125;</span><br><span class="line"> </span><br><span class="line">	//redis集群</span><br><span class="line">	@Test</span><br><span class="line">	public void testJedisCluster() &#123;</span><br><span class="line">	JedisCluster jedisCluster = (JedisCluster) applicationContext</span><br><span class="line">					.getBean(&quot;jedisCluster&quot;);</span><br><span class="line">			</span><br><span class="line">			jedisCluster.set(&quot;name&quot;, &quot;zhangsan&quot;);</span><br><span class="line">			String value = jedisCluster.get(&quot;name&quot;);</span><br><span class="line">			System.out.println(value);</span><br><span class="line">	&#125;</span><br></pre></td></tr></table></figure>




















        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-06T05:47:59.000Z" itemprop="datePublished">2019-11-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/redis-linux/' title=''>redis linux</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/redis/" rel="tag">redis</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-about-servlet" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/06/about-servlet/">Spring Boot 优雅的入门篇</a>
  

      </h3>
      <div class="repo-list-description">
        
          <p><img src="http://image.tengj.top/spring.jpg#pic_center" alt="SpringBoot"></p>
<h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Spring一直是很火的一个开源框架，在过去的一段时间里，Spring Boot在社区中热度一直很高，所以决定花时间来了解和学习，为自己做技术储备。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>首先声明，Spring Boot不是一门新技术，所以不用紧张。从本质上来说，Spring Boot就是Spring,它做了那些没有它你也会去做的Spring Bean配置。它使用“习惯优于配置”（项目中存在大量的配置，此外还内置了一个习惯性的配置，让你无需手动进行配置）的理念让你的项目快速运行起来。使用Spring Boot很容易创建一个独立运行（运行jar,内嵌Servlet容器）、准生产级别的基于Spring框架的项目，使用Spring Boot你可以不用或者只需要很少的Spring配置。</p>
<h3 id="Spring-Boot精要"><a href="#Spring-Boot精要" class="headerlink" title="Spring Boot精要"></a>Spring Boot精要</h3><p>Spring将很多魔法带入了Spring应用程序的开发之中，其中最重要的是以下四个核心。<br>1.自动配置：针对很多Spring应用程序常见的应用功能，Spring Boot能自动提供相关配置<br>2.起步依赖：告诉Spring Boot需要什么功能，它就能引入需要的库。<br>3.命令行界面：这是Spring Boot的可选特性，借此你只需写代码就能完成完整的应用程序，无需传统项目构建。<br>4.Actuator：让你能够深入运行中的Spring Boot应用程序，一探究竟。</p>
<h3 id="系统要求"><a href="#系统要求" class="headerlink" title="系统要求"></a>系统要求</h3><p>目前Spring Boot正式版为1.5.1.RELEASE默认情况下，Spring Boot 1.5.1.RELEASE需要Java 7和Spring Framework 4.3.6.RELEASE或更高版本,你也可以使用Spring Boot with Java 6和一些额外的配置（不建议）,使用Maven（3.2+）或Gradle 2（2.9或更高版本）和3来构建。</p>
<blockquote>
<p>虽然你可以使用Java 6或7的Spring Boot，但我们通常推荐Java 8</p>
</blockquote>
<h3 id="优雅的Web入门开发"><a href="#优雅的Web入门开发" class="headerlink" title="优雅的Web入门开发"></a>优雅的Web入门开发</h3><p>没有比较就没有伤害，让我们先看看传统Spring MVC开发一个简单的Hello World Web应用程序，你应该做什么，我能想到一些基本的需求。<br>1.一个项目结构，其中有一个包含必要依赖的Maven或者Gradle构建文件，最起码要有Spring MVC和Servlet API这些依赖。<br>2.一个web.xml文件（或者一个WebApplicationInitializer实现），其中声明了Spring的DispatcherServlet。<br>3.一个启动了Spring MVC的Spring配置<br>4.一个控制器类，以“hello World”相应HTTP请求。<br>5.一个用于部署应用程序的Web应用服务器，比如Tomcat。<br>最让人难以接受的是，这份清单里面只有一个东西是和Hello World功能相关的，即控制器，剩下的都是Spring开发的Web应用程序必需的通用模板。<br>接下来看看Spring Boot如何搞定？<br>很简单，我仅仅只需要非常少的几个配置就可以迅速方便的搭建起来一套web项目</p>
<h3 id="初始化Spring-Boot项目"><a href="#初始化Spring-Boot项目" class="headerlink" title="初始化Spring Boot项目"></a>初始化Spring Boot项目</h3><p>构建一个Sping Boot的Maven项目，强烈推荐Spring Initializr,它从本质上来说就是一个Web应用程序，它能为你生成Spring Boot项目结构。<br>Spring Initializr有几种用法：</p>
<ul>
<li>通过Web界面使用</li>
</ul>
<p>1.访问：(<a href="http://start.spring.io/" target="_blank" rel="noopener">http://start.spring.io/</a>)<br>2.选择构建工具Maven Project、Spring Boot版本1.5.1以及一些工程基本信息，可参考下图所示：<br><img src="http://image.tengj.top/springboot1-1.png#pic_center" alt=""><br>3.点击Generate Project下载项目压缩包<br>4.导入到你的工程，如果是IDEA，则需要：<br>      a.菜单中选择File–&gt;New–&gt;Project from Existing Sources…<br>      b.选择解压后的项目文件夹，点击OK<br>      c.点击Import project from external model并选择Maven，点击Next到底为止。<br>      d.若你的环境有多个版本的JDK，注意到选择Java SDK的时候请选择Java 7以上的版本</p>
<ul>
<li>通过IntelliJ IDEA使用(个人推荐)IntelliJ IDEA是非常流行的IDE，IntelliJ IDEA 14.1已经支持Spring Boot了。<br>创建Spring Boot操作步骤如下：</li>
</ul>
<p>1.在File菜单里面选择 New &gt; Project,然后选择Spring Initializr，接着如下图一步步操作即可。<br><img src="http://image.tengj.top/springboot1-2.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-3.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-4.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-5.png#pic_center" alt=""></p>
<h3 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h3><p>根据上面的操作已经初始化了一个Spring Boot的框架了，项目结构如下：<br><img src="http://image.tengj.top/springboot1-6.png#pic_center" alt=""><br>如你所见，项目里面基本没有代码，除了几个空目录外，还包含如下几样东西。</p>
<ul>
<li>pom.xml：Maven构建说明文件。</li>
<li>Chapter1Application.java：一个带有main()方法的类，用于启动应用程序（关键）。</li>
<li>Chapter1ApplicationTests.java：一个空的Junit测试类，它加载了一个使用Spring Boot字典配置功能的Spring应用程序上下文。</li>
<li>application.properties：一个空的properties文件，你可以根据需要添加配置属性。<h3 id="解析pom-xml文件"><a href="#解析pom-xml文件" class="headerlink" title="解析pom.xml文件"></a>解析pom.xml文件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span><br><span class="line">&lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span><br><span class="line">    xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd&quot;&gt;</span><br><span class="line">    &lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;</span><br><span class="line"></span><br><span class="line">    &lt;groupId&gt;com.dudu&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;chapter1&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</span><br><span class="line">    &lt;packaging&gt;jar&lt;/packaging&gt;</span><br><span class="line"></span><br><span class="line">    &lt;name&gt;chapter1&lt;/name&gt;</span><br><span class="line">    &lt;description&gt;Demo project for Spring Boot&lt;/description&gt;</span><br><span class="line"></span><br><span class="line">    &lt;parent&gt;</span><br><span class="line">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">        &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">        &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">        &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">    &lt;/parent&gt;</span><br><span class="line"></span><br><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line">        &lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;</span><br><span class="line">        &lt;java.version&gt;1.8&lt;/java.version&gt;</span><br><span class="line">    &lt;/properties&gt;</span><br><span class="line"></span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line"></span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;</span><br><span class="line">            &lt;scope&gt;test&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line"></span><br><span class="line">    &lt;build&gt;</span><br><span class="line">        &lt;plugins&gt;</span><br><span class="line">            &lt;plugin&gt;</span><br><span class="line">                &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">                &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">            &lt;/plugin&gt;</span><br><span class="line">        &lt;/plugins&gt;</span><br><span class="line">    &lt;/build&gt;</span><br><span class="line">&lt;/project&gt;</span><br></pre></td></tr></table></figure>
可以看出，有几个配置是不大一样的,我们挑几个重要的说说，要是客观不想过早的了解这些，自行跳过这一知识点即可。<h3 id="Spring-Boot父级依赖"><a href="#Spring-Boot父级依赖" class="headerlink" title="Spring Boot父级依赖"></a>Spring Boot父级依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;parent&gt;</span><br><span class="line">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">    &lt;relativePath/&gt; &lt;!-- lookup parent from repository --&gt;</span><br><span class="line">&lt;/parent&gt;</span><br></pre></td></tr></table></figure>
 这块配置就是Spring Boot父级依赖，有了这个，当前的项目就是Spring Boot项目了，spring-boot-starter-parent是一个特殊的starter,它用来提供相关的Maven默认依赖，使用它之后，常用的包依赖可以省去version标签。关于Spring Boot提供了哪些jar包的依赖，可查看C:\Users\用户.m2\repository\org\springframework\boot\spring-boot-dependencies\1.5.1.RELEASE\spring-boot-dependencies-1.5.1.RELEASE.pom<br>这里我就贴一点点意思意思，如下：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">        &lt;!-- Dependency versions --&gt;</span><br><span class="line">        &lt;activemq.version&gt;5.14.3&lt;/activemq.version&gt;</span><br><span class="line">        &lt;antlr2.version&gt;2.7.7&lt;/antlr2.version&gt;</span><br><span class="line">        &lt;appengine-sdk.version&gt;1.9.48&lt;/appengine-sdk.version&gt;</span><br><span class="line">        &lt;artemis.version&gt;1.5.2&lt;/artemis.version&gt;</span><br><span class="line">        &lt;aspectj.version&gt;1.8.9&lt;/aspectj.version&gt;</span><br><span class="line">        &lt;assertj.version&gt;2.6.0&lt;/assertj.version&gt;</span><br><span class="line">        &lt;atomikos.version&gt;3.9.3&lt;/atomikos.version&gt;</span><br><span class="line">        &lt;bitronix.version&gt;2.1.4&lt;/bitronix.version&gt;</span><br><span class="line">        &lt;caffeine.version&gt;2.3.5&lt;/caffeine.version&gt;</span><br><span class="line">        &lt;cassandra-driver.version&gt;3.1.3&lt;/cassandra-driver.version&gt;</span><br><span class="line">        &lt;classmate.version&gt;1.3.3&lt;/classmate.version&gt;</span><br><span class="line">        &lt;commons-beanutils.version&gt;1.9.3&lt;/commons-beanutils.version&gt;</span><br><span class="line">        &lt;commons-collections.version&gt;3.2.2&lt;/commons-collections.version&gt;</span><br><span class="line">        &lt;spring-data-releasetrain.version&gt;Ingalls-RELEASE&lt;/spring-data-releasetrain.version&gt;</span><br><span class="line">        ......</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>
如果你不想使用某个依赖默认的版本，您还可以通过覆盖自己的项目中的属性来覆盖各个依赖项，例如，要升级到另一个Spring Data版本系列，您可以将以下内容添加到pom.xml中。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;properties&gt;</span><br><span class="line">    &lt;spring-data-releasetrain.version&gt;Fowler-SR2&lt;/spring-data-releasetrain.version&gt;</span><br><span class="line">&lt;/properties&gt;</span><br></pre></td></tr></table></figure>
原本默认版本是Ingalls-RELEASE的（看上面最后一行有说明Ingalls-RELEASE），现在就使用Fowler-SR2版本了，简单吧。<br>并不是每个人都喜欢继承自spring-boot-starter-parent POM。您可能有您需要使用的自己的公司标准parent，或者您可能更喜欢显式声明所有的Maven配置。<br>如果你不想使用spring-boot-starter-parent，您仍然可以通过使用scope = import依赖关系来保持依赖关系管理：<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">     &lt;dependencies&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;!-- Import dependency management from Spring Boot --&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>
该设置不允许您使用如上所述的属性(properties)覆盖各个依赖项，要实现相同的结果，您需要在spring-boot-dependencies项之前的项目的dependencyManagement中添加一个配置，例如，要升级到另一个Spring Data版本系列，您可以将以下内容添加到pom.xml中。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependencyManagement&gt;</span><br><span class="line">    &lt;dependencies&gt;</span><br><span class="line">        &lt;!-- Override Spring Data release train provided by Spring Boot --&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.data&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-data-releasetrain&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;Fowler-SR2&lt;/version&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">        &lt;dependency&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;</span><br><span class="line">            &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;</span><br><span class="line">            &lt;type&gt;pom&lt;/type&gt;</span><br><span class="line">            &lt;scope&gt;import&lt;/scope&gt;</span><br><span class="line">        &lt;/dependency&gt;</span><br><span class="line">    &lt;/dependencies&gt;</span><br><span class="line">&lt;/dependencyManagement&gt;</span><br></pre></td></tr></table></figure>
<h3 id="起步依赖-spring-boot-starter-xx"><a href="#起步依赖-spring-boot-starter-xx" class="headerlink" title="起步依赖 spring-boot-starter-xx"></a>起步依赖 spring-boot-starter-xx</h3>Spring Boot提供了很多”开箱即用“的依赖模块，都是以spring-boot-starter-xx作为命名的。举个例子来说明一下这个起步依赖的好处，比如组装台式机和品牌机，自己组装的话需要自己去选择不同的零件，最后还要组装起来，期间有可能会遇到零件不匹配的问题。耗时又消力，而品牌机就好一点，买来就能直接用的，后续想换零件也是可以的。相比较之下，后者带来的效果更好点（这里就不讨论价格问题哈），起步依赖就像这里的品牌机，自动给你封装好了你想要实现的功能的依赖。就比如我们之前要实现web功能，引入了spring-boot-starter-web这个起步依赖。我们来看看spring-boot-starter-web到底依赖了哪些,如下图：<br><img src="http://image.tengj.top/springboot1-7.png#pic_center" alt=""><br>嘿嘿嘿，看来依赖了好多呢，如果让我自己弄估计要调半天，所以Spring Boot通过提供众多起步依赖降低项目依赖的复杂度。起步依赖本质上是一个Maven项目对象模型（Project Object Model，POM），定义了对其他库的传递依赖，这些东西加在一起即支持某项功能。很多起步依赖的命名都暗示了它们提供的某种或者某类功能。<h3 id="Spring-Boot-Maven插件"><a href="#Spring-Boot-Maven插件" class="headerlink" title="Spring Boot Maven插件"></a>Spring Boot Maven插件</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;build&gt;</span><br><span class="line">    &lt;plugins&gt;</span><br><span class="line">        &lt;plugin&gt;</span><br><span class="line">            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">            &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;</span><br><span class="line">        &lt;/plugin&gt;</span><br><span class="line">    &lt;/plugins&gt;</span><br><span class="line">&lt;/build&gt;</span><br></pre></td></tr></table></figure></li>
</ul>
<p>1.上面的配置就是Spring Boot Maven插件，Spring Boot Maven插件提供了许多方便的功能：<br>把项目打包成一个可执行的超级JAR（uber-JAR）,包括把应用程序的所有依赖打入JAR文件内，并为JAR添加一个描述文件，其中的内容能让你用java -jar来运行应用程序。<br>2.搜索public static void main()方法来标记为可运行类。</p>
<h3 id="应用程序入口类"><a href="#应用程序入口类" class="headerlink" title="应用程序入口类"></a>应用程序入口类</h3><p>Chapter1Application是一个很关键的启动类，程序的入口就是这里,为了演示简单，我们不再新建控制类，而是直接在这个入口类中编写，添加@RestController以及index方法，如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">package com.dudu;</span><br><span class="line"></span><br><span class="line">import org.springframework.boot.SpringApplication;</span><br><span class="line">import org.springframework.boot.autoconfigure.SpringBootApplication;</span><br><span class="line">import org.springframework.web.bind.annotation.RequestMapping;</span><br><span class="line">import org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line">@RestController</span><br><span class="line">@SpringBootApplication</span><br><span class="line">public class Chapter1Application &#123;</span><br><span class="line"></span><br><span class="line">	@RequestMapping(&quot;/&quot;)</span><br><span class="line">	public String index()&#123;</span><br><span class="line">		return &quot;Hello Spring Boot&quot;;</span><br><span class="line">	&#125;</span><br><span class="line">	public static void main(String[] args) &#123;</span><br><span class="line">		SpringApplication.run(Chapter1Application.class, args);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>1.@SpringBootApplication是Sprnig Boot项目的核心注解，主要目的是开启自动配置。后续讲解原理的时候再深入介绍。<br>2.main方法这是一个标准的Java应用的main的方法，主要作用是作为项目启动的入口。<br>3.@RestController注解等价于@Controller+@ResponseBody的结合，使用这个注解的类里面的方法都以json格式输出。</p>
<p><strong>最后，启动项目有三种方式</strong>：<br>1.Chapter1Application的main方法<br><img src="http://image.tengj.top/springboot1-8.png#pic_center" alt=""><br>2.使用命令 mvn spring-boot:run”在命令行启动该应用，IDEA中该命令在如下位置：<br><img src="http://image.tengj.top/springboot1-9.png#pic_center" alt=""><br>3.运行“mvn package”进行打包时，会打包成一个可以直接运行的 JAR 文件，使用“java -jar”命令就可以直接运行。<br><img src="http://image.tengj.top/springboot1-10.png#pic_center" alt=""><br><img src="http://image.tengj.top/springboot1-11.png#pic_center" alt=""><br>打开浏览器访问(<a href="http://localhost:8080" target="_blank" rel="noopener">http://localhost:8080</a>), 你就能看到页面显示Hello Spring Boot效果了，一个简单的Web的项目就是如此简单。</p>
<h3 id="结束"><a href="#结束" class="headerlink" title="结束"></a>结束</h3><p>虽然我上面讲解了那么多，但是实际开发步骤就是那么简单暴力，初始化一个Spring Boot，添加一个控制类，启动就能看到效果了。<br>本章作为入门Spring Boot的入门介绍，相关的需要理解的概念就只有这几点：</p>
<ul>
<li>Spring Boot父级依赖的概念</li>
<li>起步依赖 spring-boot-starter-xx的概念</li>
<li>应用入口类的作用</li>
</ul>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-06T04:54:15.000Z" itemprop="datePublished">2019-11-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
                  <article id="post-java" class="repo-list">
    <div class="repo-list-item" >
      <h3 class="repo-list-name" itemprop="name">
        
  
      <a class="article-title" href="/2019/11/06/java/">Spring Boot 开发Web应用之Thymeleaf篇</a>
  

      </h3>
      <div class="repo-list-description">
        
          <h3 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h3><p>Web开发是我们平时开发中至关重要的，这里就来介绍一下Spring Boot对Web开发的支持。</p>
<h3 id="正文"><a href="#正文" class="headerlink" title="正文"></a>正文</h3><p>Spring Boot提供了spring-boot-starter-web为Web开发予以支持，spring-boot-starter-web为我们提供了嵌入的Tomcat以及Spring MVC的依赖。</p>
<h3 id="项目结构推荐"><a href="#项目结构推荐" class="headerlink" title="项目结构推荐"></a>项目结构推荐</h3><p>一个好的项目结构会让你开发少一些问题，特别是Spring Boot中启动类要放在root package下面，我的web工程项目结构如下：<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC0xLmpwZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>1.root package结构：com.dudu<br>2.应用启动类Application.java置于root package下，这样使用@ComponentScan注解的时候默认就扫描当前所在类的package<br>3.实体（Entity）置于com.dudu.domain包下<br>4.逻辑层（Service）置于com.dudu.service包下<br>5.controller层（web）置于com.dudu.controller层包下<br>6.static可以用来存放静态资源<br>7.templates用来存放默认的模板配置路径</p>
<h3 id="Spring-Web-MVC框架介绍"><a href="#Spring-Web-MVC框架介绍" class="headerlink" title="Spring Web MVC框架介绍"></a>Spring Web MVC框架介绍</h3><p>Spring Web MVC框架（通常简称为”Spring MVC”）是一个富”模型，视图，控制器”的web框架。<br>Spring MVC允许你创建特定的@Controller或@RestController beans来处理传入的HTTP请求。<br>示例：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">@RestController</span><br><span class="line">@RequestMapping(value=&quot;/users&quot;)</span><br><span class="line">public class MyRestController &#123;</span><br><span class="line">@RequestMapping(value=&quot;/&#123;user&#125;&quot;, method=RequestMethod.GET)</span><br><span class="line">public User getUser(@PathVariable Long user) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">@RequestMapping(value=&quot;/&#123;user&#125;/customers&quot;, method=RequestMethod.GET)</span><br><span class="line">List&lt;Customer&gt; getUserCustomers(@PathVariable Long user) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">@RequestMapping(value=&quot;/&#123;user&#125;&quot;, method=RequestMethod.DELETE)</span><br><span class="line">public User deleteUser(@PathVariable Long user) &#123;</span><br><span class="line">// ...</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="Spring-MVC自动配置"><a href="#Spring-MVC自动配置" class="headerlink" title="Spring MVC自动配置"></a>Spring MVC自动配置</h3><p>Spring Boot为Spring MVC提供适用于多数应用的自动配置功能。在Spring默认基础上，自动配置添加了以下特性：</p>
<p>1.引入ContentNegotiatingViewResolver和BeanNameViewResolver beans。<br>2.对静态资源的支持，包括对WebJars的支持。<br>3.自动注册Converter，GenericConverter，Formatter beans。<br>4.对HttpMessageConverters的支持。<br>5.自动注册MessageCodeResolver。<br>6.对静态index.html的支持。<br>7.对自定义Favicon的支持。<br>如果想全面控制Spring MVC，你可以添加自己的@Configuration，并使用@EnableWebMvc对其注解。如果想保留Spring Boot MVC的特性，并只是添加其他的MVC配置(拦截器，formatters，视图控制器等)，你可以添加自己的WebMvcConfigurerAdapter类型的@Bean（不使用@EnableWebMvc注解）,具体拦截器等配置后续文章会解析。</p>
<h3 id="静态文件"><a href="#静态文件" class="headerlink" title="静态文件"></a>静态文件</h3><p>默认情况下，Spring Boot从classpath下一个叫/static（/public，/resources或/META-INF/resources）的文件夹或从ServletContext根目录提供静态内容。这使用了Spring MVC的ResourceHttpRequestHandler，所以你可以通过添加自己的WebMvcConfigurerAdapter并覆写addResourceHandlers方法来改变这个行为（加载静态文件）。</p>
<p>在一个单独的web应用中，容器默认的servlet是开启的，如果Spring决定不处理某些请求，默认的servlet作为一个回退（降级）将从ServletContext根目录加载内容。大多数时候，这不会发生（除非你修改默认的MVC配置），因为Spring总能够通过DispatcherServlet处理请求。</p>
<p>此外，上述标准的静态资源位置有个例外情况是Webjars内容。任何在/webjars/**路径下的资源都将从jar文件中提供，只要它们以Webjars的格式打包。</p>
<p>注：如果你的应用将被打包成jar，那就不要使用src/main/webapp文件夹。尽管该文件夹是一个共同的标准，但它仅在打包成war的情况下起作用，并且如果产生一个jar，多数构建工具都会静悄悄的忽略它</p>
<h3 id="模板引擎"><a href="#模板引擎" class="headerlink" title="模板引擎"></a>模板引擎</h3><p>Spring Boot支持多种模版引擎包括：</p>
<p>1.FreeMarker<br>2.Groovy<br>3.Thymeleaf(官方推荐)<br>4.Mustache</p>
<p>JSP技术Spring Boot官方是不推荐的，原因有三：</p>
<p>1.tomcat只支持war的打包方式，不支持可执行的jar。<br>2.Jetty 嵌套的容器不支持jsp<br>3.Undertow<br>4.创建自定义error.jsp页面不会覆盖错误处理的默认视图，而应该使用自定义错误页面</p>
<p>当你使用上述模板引擎中的任何一个，它们默认的模板配置路径为：src/main/resources/templates。当然也可以修改这个路径，具体如何修改，可在后续各模板引擎的配置属性中查询并修改。</p>
<h3 id="Thymeleaf模板引擎"><a href="#Thymeleaf模板引擎" class="headerlink" title="Thymeleaf模板引擎"></a>Thymeleaf模板引擎</h3><p>Thymeleaf是一款用于渲染XML/XHTML/HTML5内容的模板引擎。类似JSP，Velocity，FreeMaker等，它也可以轻易的与Spring MVC等Web框架进行集成作为Web应用的模板引擎。与其它模板引擎相比，Thymeleaf最大的特点是能够直接在浏览器中打开并正确显示模板页面，而不需要启动整个Web应用。它的功能特性如下：</p>
<p>1.Spring MVC中@Controller中的方法可以直接返回模板名称，接下来Thymeleaf模板引擎会自动进行渲染<br>2.模板中的表达式支持Spring表达式语言（Spring EL)<br>3.表单支持，并兼容Spring MVC的数据绑定与验证机制<br>4.国际化支持<br> Spring官方也推荐使用Thymeleaf,所以本篇代码整合就使用Thymeleaf来整合。</p>
<h3 id="引入依赖"><a href="#引入依赖" class="headerlink" title="引入依赖"></a>引入依赖</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;dependency&gt;</span><br><span class="line">&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</span><br><span class="line">&lt;artifactId&gt;spring-boot-starter-thymeleaf&lt;/artifactId&gt;</span><br><span class="line">&lt;/dependency&gt;</span><br></pre></td></tr></table></figure>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC0yLmpwZw?x-oss-process=image/format,png#pic_center" alt=""><br>如图所示，spring-boot-starter-thymeleaf会自动包含spring-boot-starter-web，所以我们就不需要单独引入web依赖了。</p>
<h3 id="编写controller"><a href="#编写controller" class="headerlink" title="编写controller"></a>编写controller</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">@Controller</span><br><span class="line">@RequestMapping(&quot;/learn&quot;)</span><br><span class="line">public class LearnResourceController &#123;</span><br><span class="line">@RequestMapping(&quot;/&quot;)</span><br><span class="line">public ModelAndView index()&#123;</span><br><span class="line">List&lt;LearnResouce&gt; learnList =new ArrayList&lt;LearnResouce&gt;();</span><br><span class="line">LearnResouce bean =new LearnResouce(&quot;官方参考文档&quot;,&quot;Spring Boot Reference Guide&quot;,&quot;http://docs.spring.io/spring-boot/docs/1.5.1.RELEASE/reference/htmlsingle/#getting-started-first-application&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;官方SpriongBoot例子&quot;,&quot;官方SpriongBoot例子&quot;,&quot;https://github.com/spring-projects/spring-boot/tree/master/spring-boot-samples&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;龙国学院&quot;,&quot;Spring Boot 教程系列学习&quot;,&quot;http://www.roncoo.com/article/detail/125488&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;嘟嘟MD独立博客&quot;,&quot;Spring Boot干货系列 &quot;,&quot;http://tengj.top/&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;后端编程嘟&quot;,&quot;Spring Boot教程和视频 &quot;,&quot;http://www.toutiao.com/m1559096720023553/&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;程序猿DD&quot;,&quot;Spring Boot系列&quot;,&quot;http://www.roncoo.com/article/detail/125488&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;纯洁的微笑&quot;,&quot;Sping Boot系列文章&quot;,&quot;http://www.ityouknow.com/spring-boot&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;CSDN——小当博客专栏&quot;,&quot;Sping Boot学习&quot;,&quot;http://blog.csdn.net/column/details/spring-boot.html&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;梁桂钊的博客&quot;,&quot;Spring Boot 揭秘与实战&quot;,&quot;http://blog.csdn.net/column/details/spring-boot.html&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">bean =new LearnResouce(&quot;林祥纤博客系列&quot;,&quot;从零开始学Spring Boot &quot;,&quot;http://412887952-qq-com.iteye.com/category/356333&quot;);</span><br><span class="line">learnList.add(bean);</span><br><span class="line">ModelAndView modelAndView = new ModelAndView(&quot;/index&quot;);</span><br><span class="line">modelAndView.addObject(&quot;learnList&quot;, learnList);</span><br><span class="line">return modelAndView;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="编写html"><a href="#编写html" class="headerlink" title="编写html"></a>编写html</h3><p>引入依赖后就在默认的模板路径src/main/resources/templates下编写模板文件即可完成。这里我们新建一个index.html:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html xmlns:th=&quot;http://www.thymeleaf.org&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">&lt;title&gt;learn Resources&lt;/title&gt;</span><br><span class="line">&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text/html; charset=UTF-8&quot; /&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line"></span><br><span class="line">&lt;div style=&quot;text-align: center;margin:0 auto;width: 1000px; &quot;&gt;</span><br><span class="line">&lt;h1&gt;学习资源大奉送，爱我就关注嘟嘟公众号：嘟爷java超神学堂（javaLearn）&lt;/h1&gt;</span><br><span class="line">&lt;table width=&quot;100%&quot; border=&quot;1&quot; cellspacing=&quot;1&quot; cellpadding=&quot;0&quot;&gt;</span><br><span class="line">&lt;tr&gt;</span><br><span class="line">&lt;td&gt;作者&lt;/td&gt;</span><br><span class="line">&lt;td&gt;教程名称&lt;/td&gt;</span><br><span class="line">&lt;td&gt;地址&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;!--/*@thymesVar id=&quot;learnList&quot; type=&quot;&quot;*/--&gt;</span><br><span class="line">&lt;tr th:each=&quot;learn : $&#123;learnList&#125;&quot;&gt;</span><br><span class="line">&lt;td th:text=&quot;$&#123;learn.author&#125;&quot;&gt;嘟嘟MD&lt;/td&gt;</span><br><span class="line">&lt;td th:text=&quot;$&#123;learn.title&#125;&quot;&gt;SPringBoot干货系列&lt;/td&gt;</span><br><span class="line">&lt;td&gt;&lt;a th:href=&quot;$&#123;learn.url&#125;&quot; target=&quot;_blank&quot;&gt;点我&lt;/a&gt;&lt;/td&gt;</span><br><span class="line">&lt;/tr&gt;</span><br><span class="line">&lt;/table&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>


<blockquote>
<p>注：通过xmlns:th=”<a href="http://www.thymeleaf.org“" target="_blank" rel="noopener">http://www.thymeleaf.org“</a> 命令空间，将静态页面转换为动态的视图，需要进行动态处理的元素将使用“th:”前缀。</p>
</blockquote>
<h3 id="Thymeleaf的默认参数配置"><a href="#Thymeleaf的默认参数配置" class="headerlink" title="Thymeleaf的默认参数配置"></a>Thymeleaf的默认参数配置</h3><p>在application.properties中可以配置thymeleaf模板解析器属性</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"># THYMELEAF (ThymeleafAutoConfiguration)</span><br><span class="line">#开启模板缓存（默认值：true）</span><br><span class="line">spring.thymeleaf.cache=true </span><br><span class="line">#Check that the template exists before rendering it.</span><br><span class="line">spring.thymeleaf.check-template=true </span><br><span class="line">#检查模板位置是否正确（默认值:true）</span><br><span class="line">spring.thymeleaf.check-template-location=true</span><br><span class="line">#Content-Type的值（默认值：text/html）</span><br><span class="line">spring.thymeleaf.content-type=text/html</span><br><span class="line">#开启MVC Thymeleaf视图解析（默认值：true）</span><br><span class="line">spring.thymeleaf.enabled=true</span><br><span class="line">#模板编码</span><br><span class="line">spring.thymeleaf.encoding=UTF-8</span><br><span class="line">#要被排除在解析之外的视图名称列表，用逗号分隔</span><br><span class="line">spring.thymeleaf.excluded-view-names=</span><br><span class="line">#要运用于模板之上的模板模式。另见StandardTemplate-ModeHandlers(默认值：HTML5)</span><br><span class="line">spring.thymeleaf.mode=HTML5</span><br><span class="line">#在构建URL时添加到视图名称前的前缀（默认值：classpath:/templates/）</span><br><span class="line">spring.thymeleaf.prefix=classpath:/templates/</span><br><span class="line">#在构建URL时添加到视图名称后的后缀（默认值：.html）</span><br><span class="line">spring.thymeleaf.suffix=.html</span><br><span class="line">#Thymeleaf模板解析器在解析器链中的顺序。默认情况下，它排第一位。顺序从1开始，只有在定义了额外的TemplateResolver Bean时才需要设置这个属性。</span><br><span class="line">spring.thymeleaf.template-resolver-order=</span><br><span class="line">#可解析的视图名称列表，用逗号分隔</span><br><span class="line">spring.thymeleaf.view-names=</span><br></pre></td></tr></table></figure>


<h3 id="整合一个bootstrap框架给大家"><a href="#整合一个bootstrap框架给大家" class="headerlink" title="整合一个bootstrap框架给大家"></a>整合一个bootstrap框架给大家</h3><p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC00LmpwZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>大家可以直接打开vanilla-cream-css下面的index.html来查看静态效果，如下：<br><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC01LmpwZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<p>动态效果的话可以查看template.html<br>这里把上面的资源例子重新用bootstrap写了下，效果不错哦，如下：</p>
<p><img src="https://imgconvert.csdnimg.cn/aHR0cDovL2ltYWdlLnRlbmdqLnRvcC9zcHJpbmdib290NC02LnBuZw?x-oss-process=image/format,png#pic_center" alt=""></p>
<h3 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h3><p>本章到此就结束了，下一篇准备介绍下如何整合jsp,毕竟现在绝大多数的企业还是用jsp来作为模板引擎的。</p>

        
      </div>
      <p class="repo-list-meta">
        <span class="meta-info">
          <span class="octicon octicon-calendar"></span>
           <time datetime="2019-11-06T04:19:21.000Z" itemprop="datePublished">2019-11-06</time>
        </span>

        
          <span class="meta-info">
            <span class="octicon octicon-file-directory"></span>
            <a href='/categories/SpringBoot/' title=''>SpringBoot</a>
          </span>
        
      
        <!--
          
            <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/SpringBoot/" rel="tag">SpringBoot</a></li></ul>
          
        -->

      </p>
    </div>
  </article>
            
        </div>
        <div class="column one-third">
          <!--处理未安装 search 插件 默认 Google 搜索-->
 

<h3>Search</h3>

<div id="site_search">

	<!-- Google -->
	

	<!-- 本地搜索 -->
	
		<form id="search-form" >
			<input type="text" id="search" placeholder="Search" >
			<button type="button" class="btn btn-default" id="site_search_do"><span class="octicon octicon-search"></span></button>
		</form>

		<div id="local-search-result"></div>

		<script src="/js/search.js"></script>	
		<script type="text/javascript">
			$(function(){
				var currentIndex = -1;
				var search_path = "search.xml";
				if (!search_path) search_path = "search.xml";
				var path = "/" + search_path;
				searchFunc(path, 'search', 'local-search-result');

				$(document).delegate("#local-search-result>.search-result-list li","hover",function(){
					var liNode = $("#local-search-result>.search-result-list li");
					liNode.removeClass("hover");
					currentIndex = $("#local-search-result>.search-result-list li").index($(this));
					liNode.eq(currentIndex).addClass("hover");
				})

				$("#search-form").submit(function(){
					return false;
				})

				$("#search").keydown(function(event){
					var keyCode = event.keyCode;
					var liNode = $("#local-search-result>.search-result-list li");
					if(keyCode == 38 || keyCode == 40 || keyCode == 13){
						liNode.removeClass("hover");
						if(keyCode == 38){
							if(currentIndex - 1 >= 0) currentIndex --;
						}
						if(keyCode == 40){
							if(currentIndex + 1 < liNode.length) currentIndex ++;
						}
						if(keyCode == 13){
							location.href = liNode.eq(currentIndex).find("a").attr("href");
						}
						liNode.eq(currentIndex).addClass("hover");
						return false;
					}else{
						currentIndex = -1;
					}
				})
			})
		</script>

	

</div>

<h3>Popular Repositories</h3>
    <div class="popular-container"></div>
    
    <script type="text/template" id="popular-list-template">
        <a href="{%=clone_url%}" class="card text-center" target="_blank">
            <div class="thumbnail">
                <div class="card-image geopattern" data-pattern-id="{%=name%}">
                    <div class="card-image-cell">
                        <h3 class="card-title">
                            {%=name%}
                        </h3>
                    </div>
                </div>
                <div class="caption">
                    <div class="card-description">
                        <p class="card-text">
                            {%=description%}
                        </p>
                    </div>
                    <div class="card-text">
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=stargazers_count%} stars">
                            <span class="octicon octicon-star"></span> {%=stargazers_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="{%=forks_count%} forks">
                            <span class="octicon octicon-git-branch"></span> {%=forks_count%}
                        </span>
                        <span class="meta-info tooltipped tooltipped-n" aria-label="最后更新时间：{%=updated_at%}">
                            <span class="octicon octicon-clock"></span>
                            <time datetime="{%=updated_at%}">{%=updated_at%}</time>
                        </span>
                    </div>
                </div>
            </div>
        </a>
    </script>

    <script src="/js/baiduTemplate.js"></script>
    <script type="text/javascript">
        var popular_repos = function(){

            var baiduTpl = new Object();

            var handleTpl = function(){
                baiduTpl.popular_list = baidu.template("popular-list-template");
            };

            var handleGithub = function(){
                var popularContainer = $(".popular-container");

                var repos = "vue-hr,vue-mobil,spring-boot-examples".split(",");
                for(var i in repos){
                    var name = repos[i];
                    $.get("https://api.github.com/repos/vanicesun/"+name,handle);
                }

                function handle(result){
                    result.updated_at = result.updated_at.split("T")[0];
                    if(result){
                        var html = baiduTpl.popular_list(result);
                        popularContainer.append(html);
                        $(".geopattern").each(function(){           
                            $(this).geopattern($(this).data('pattern-id'));
                        });
                    }
                }
            };

            return {
                init:function(){
                    handleTpl();
                    handleGithub();
                }
            }
        }; 
        $(popular_repos().init);
    </script>

        </div>
    </div>

    
      <div class="pagination text-align">
          <div class="btn-group">
              <a class="extend prev" rel="prev" href="/page/2/">&amp;laquo;</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><span class="page-number current">3</span>
          </div>
      </div>
    
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" target="_blank" rel="noopener" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" target="_blank" rel="noopener" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/hexo-theme-primer" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
                  
                  <li>
                    <a href="/"  title="首页">首页</a>
                  </li>
            
                  
                  <li>
                    <a href="/categories/"  title="分类">分类</a>
                  </li>
            
                  
                  <li>
                    <a href="/open-source/"  title="开源">开源</a>
                  </li>
            
                  
                  <li>
                    <a href="/about/"  title="关于">关于</a>
                  </li>
            
            <li>
                <a href="/atom.xml">
                    <span class="octicon octicon-rss" style="color:orange;"></span>
                </a>
            </li>
        </ul>
    </div>
</footer>

		<script src="/js/geopattern.js"></script>
		<script src="/js/highlight.pack.js"></script>
		<script src="/lib/fancybox/jquery.fancybox-1.3.4.pack.js"></script>

		

		<script src="/js/index.js"></script>

		 <script src="/js/popular_repo.js"></script> 

	</body>
</html>